<div id="user-settings-container">
    <h2 id="page-title">User Settings</h2>

    <h3>Edit Profile</h3>
    <form id="user-update-form">
        <label for="user-name">User Name</label>
        <input id="user-name" type="text" name="name" value="{{ user.name }}" />
        <label for="user-email">Email</label>
        <input id="user-email" type="email" name="email" value="{{ user.email }}" />
        <button id="update-user-btn" type="submit">Submit</button>
    </form>

    <h3>Change Password</h3>
    <form id="password-update-form">
        <label for="new-password">New Password</label>
        <input id="new-password" type="password" name="password" />
        <button id="update-password-btn" type="submit">Update Password</button>
    </form>

    <h3>Delete User Account</h3>
    <button id="delete-user-btn" type="submit">Delete User</button>

    <script>
        const messageEl = document.getElementById("response-message");
        document.getElementById("user-update-form").addEventListener("submit", async (event) => {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            const response = await fetch("/user", {
                method: "PATCH",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            });
            if (response.ok) {
                const result = await response.json();
                messageEl.textContent = result.message;
            } else {
                messageEl.textContent = "Failed to update user";
            }
        });

        document.getElementById("password-update-form").addEventListener("submit", async (event) => {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            const response = await fetch("/user/password", {
                method: "PATCH",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            });
            if (response.ok) {
                const result = await response.json();
                messageEl.textContent = result.message;
            } else {
                messageEl.textContent = "Failed to update password";
            }
        });

        document.getElementById("delete-user-btn").addEventListener("click", async () => {
            const response = await fetch(`/user`, {
                method: "DELETE",
            });
            if (response.ok) {
                const result = await response.json();
                messageEl.textContent = result.message;
            } else {
                messageEl.textContent = "Failed to delete user";
            }
        });
    </script>

</div>
