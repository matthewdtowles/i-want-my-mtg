0. Foreach s in Set: Filter s.isOnlineOnly
1. Foreach c in each s in Sets: Filter c.isOnlineOnly

1. Filter by Set Type in JSON PARSING
    FILTER_SET_TYPES = [ 'alchemy', 'minigame', 'token', 'treasure_chest' ];

    ALLOWED_SET_TYPE = [
        'archenemy',
        'arsenal',
        'box',
        'commander',
        'core',
        'draft_innovation',
        'dual_deck',
        'eternal',
        'expansion',
        'from_the_vault',
        'funny',
        'masterpiece',
        'masters',
        'memorabilia',
        'planechase',
        'premium_deck',
        'promo',
        'spellbook',
        'starter',
        'vanguard'
    ];

2. Filter by Set in JSON PARSING
    FILTER_SETS = [ 'oarc', 'oe01', 'g17', 'aa1', 'aa2', 'aa3', 'aa4', 'past', 
        'q01', 'q02', 'q03', 'q04', 'q05', 'q06', 'q07', 'q08', 'ea1', 'ea2', 
        'ea3', 'phuk', 'ha1', 'ha2', 'ha3', 'ha4', 'ha5', 'ha6', 'ha7', 'g18', 
        'td0', 'mgb', 'pa1', 'rqs', 'psal', 'ps11', 'psdg']

4. Cleanup after PARSING
    -- delete all sets without any cards
    -- will remove ~99 sets (pre-filter)
    DELETE FROM set s WHERE s.code NOT IN (SELECT DISTINCT set_code FROM card);

FILTER FOR SETS
       type       | count  | filter sets
------------------+--------+-------
 archenemy        |     4  | 2
 arsenal          |     3  | 0
 box              |    49  | 33
 commander        |    40  | 
 core             |    26
 draft_innovation |    18
 duel_deck        |    28
 eternal          |     3
 expansion        |   114
 from_the_vault   |    10
 funny            |    21
 masterpiece      |    19
 masters          |    33
 memorabilia      |    89
 planechase       |     6
 premium_deck     |     3
 promo            |   292
 spellbook        |     3
 starter          |    15
 vanguard         |     2

BOX SETS 
 code | name                          | set numbers
------+-------------------------------+---------------
 ath  | Anthologies                   | NUMBER
 brb  | Battle Royale Box Set         | NUMBER
 btd  | Beatdown Box Set              | NUMBER 
 cst  | Coldsnap Theme Decks          | NUMBER + NUMBER with letter >> Clean up required
 dkm  | Deckmasters                   | NUMBER + NUMBER+letter >> Keep or clean?
 dpa  | Duels of the Planeswalkers    | NUMBER
 e02  | Explorers of Ixalan           | NUMBER
 gk1  | GRN Guild Kit                 | NUMBER
 gnt  | Game Night                    | NUMBER
 gn2  | Game Night 2019               | NUMBER
 gn3  | Game Night: Free-for-All      | NUMBER
 md1  | Modern Event Deck 2014        | NUMBER
 gk2  | RNA Guild Kit                 | NUMBER
 slc  | Secret Lair Countdown         | NUMBER
 sld  | Secret Lair Drop              | NUMBER, NUMBER+NON-ASCII Star for FOIL
 slu  | Secret Lair: Ultimate Edition | NUMBER


i_want_my_mtg=# select distinct(number), set_code from card join set on set.code = card.set_code where set.type='expansion' and card.number
~ '[^0-9]' order by set_code;
 number | set_code 
--------+----------
 101†   | aer
 14†    | aer
 52†    | aer
 100a   | all
 100b   | all
 102a   | all
 102b   | all
 103a   | all
 103b   | all
 104a   | all
 104b   | all
 10a    | all
 10b    | all
 116a   | all
 116b   | all
 118a   | all
 118b   | all
 11a    | all
 11b    | all
 127a   | all
 127b   | all
 12a    | all
 12b    | all
 132a   | all
 132b   | all
 133a   | all
 133b   | all
 13a    | all
 13b    | all
 15a    | all
 15b    | all
 1a     | all
 1b     | all
 21a    | all
 21b    | all
 22a    | all
 22b    | all
 23a    | all
 23b    | all
 24a    | all
 24b    | all
 27a    | all
 27b    | all
 29a    | all
 29b    | all
 2a     | all
 2b     | all
 30a    | all
 30b    | all
 33a    | all
 33b    | all
 34a    | all
 34b    | all
 36a    | all
 36b    | all
 41a    | all
 41b    | all
 44a    | all
 44b    | all
 49a    | all
 49b    | all
 50a    | all
 50b    | all
 51a    | all
 51b    | all
 55a    | all
 55b    | all
 57a    | all
 57b    | all
 58a    | all
 58b    | all
 60a    | all
 60b    | all
 61a    | all
 61b    | all
 63a    | all
 63b    | all
 64a    | all
 64b    | all
 66a    | all
 66b    | all
 67a    | all
 67b    | all
 71a    | all
 71b    | all
 72a    | all
 72b    | all
 73a    | all
 73b    | all
 74a    | all
 74b    | all
 7a     | all
 7b     | all
 81a    | all
 81b    | all
 82a    | all
 82b    | all
 84a    | all
 84b    | all
 86a    | all
 86b    | all
 88a    | all
 88b    | all
 90a    | all
 90b    | all
 92a    | all
 92b    | all
 93a    | all
 93b    | all
 94a    | all
 94b    | all
 9a     | all
 9b     | all
 11†    | arn
 13†    | arn
 15†    | arn
 25†    | arn
 27†    | arn
 2†     | arn
 31†    | arn
 33†    | arn
 37†    | arn
 43†    | arn
 52†    | arn
 55†    | arn
 7†     | arn
 8†     | arn
 23†    | atq
 70†    | atq
 80a    | atq
 80b    | atq
 80c    | atq
 80d    | atq
 82a    | atq
 82b    | atq
 82c    | atq
 82d    | atq
 83a    | atq
 83b    | atq
 83c    | atq
 83d    | atq
 84a    | atq
 84b    | atq
 84c    | atq
 84d    | atq
 85a    | atq
 85b    | atq
 85c    | atq
 85d    | atq
 250a   | bfz
 251a   | bfz
 252a   | bfz
 253a   | bfz
 254a   | bfz
 255a   | bfz
 256a   | bfz
 257a   | bfz
 258a   | bfz
 259a   | bfz
 260a   | bfz
 261a   | bfz
 262a   | bfz
 263a   | bfz
 264a   | bfz
 265a   | bfz
 266a   | bfz
 267a   | bfz
 268a   | bfz
 269a   | bfz
 270a   | bfz
 271a   | bfz
 272a   | bfz
 273a   | bfz
 274a   | bfz
 163b   | bro
 238b   | bro
 256b   | bro
 160a   | chk
 160b   | chk
 103†   | drk
 107†   | drk
 77†    | drk
 A-125  | eld
 130b   | emn
 15b    | emn
 96b    | emn
 10a    | fem
 10b    | fem
 10c    | fem
 13a    | fem
 13b    | fem
 13c    | fem
 13d    | fem
 16a    | fem
 16b    | fem
 16c    | fem
 18a    | fem
 18b    | fem
 18c    | fem
 19a    | fem
 19b    | fem
 19c    | fem
 19d    | fem
 1a     | fem
 1b     | fem
 1c     | fem
 1d     | fem
 22a    | fem
 22b    | fem
 22c    | fem
 23a    | fem
 23b    | fem
 23c    | fem
 23d    | fem
 27a    | fem
 27b    | fem
 27c    | fem
 30a    | fem
 30b    | fem
 30c    | fem
 31a    | fem
 31b    | fem
 31c    | fem
 31d    | fem
 33a    | fem
 33b    | fem
 33c    | fem
 33d    | fem
 34a    | fem
 34b    | fem
 34c    | fem
 34d    | fem
 38a    | fem
 38b    | fem
 38c    | fem
 38d    | fem
 39a    | fem
 39b    | fem
 39c    | fem
 3a     | fem
 3b     | fem
 3c     | fem
 40a    | fem
 40b    | fem
 40c    | fem
 41a    | fem
 41b    | fem
 41c    | fem
 42a    | fem
 42b    | fem
 42c    | fem
 49a    | fem
 49b    | fem
 49c    | fem
 49d    | fem
 53a    | fem
 53b    | fem
 53c    | fem
 54a    | fem
 54b    | fem
 54c    | fem
 56a    | fem
 56b    | fem
 56c    | fem
 58a    | fem
 58b    | fem
 58c    | fem
 58d    | fem
 61a    | fem
 61b    | fem
 61c    | fem
 62a    | fem
 62b    | fem
 62c    | fem
 62d    | fem
 65a    | fem
 65b    | fem
 65c    | fem
 65d    | fem
 67a    | fem
 67b    | fem
 67c    | fem
 68a    | fem
 68b    | fem
 68c    | fem
 71a    | fem
 71b    | fem
 71c    | fem
 72a    | fem
 72b    | fem
 72c    | fem
 74a    | fem
 74b    | fem
 74c    | fem
 74d    | fem
 7a     | fem
 7b     | fem
 7c     | fem
 7d     | fem
 80a    | fem
 80b    | fem
 80c    | fem
 80d    | fem
 8a     | fem
 8b     | fem
 8c     | fem
 381b   | fin
 446b   | fin
 526b   | fin
 551a   | fin
 551b   | fin
 551c   | fin
 551d   | fin
 551f   | fin
 99b    | fin
 110★   | frf
 131★   | frf
 43★    | frf
 65★    | frf
 79★    | frf
 8★     | frf
 14★    | gpt
 37★    | gpt
 10a    | hml
 10b    | hml
 13a    | hml
 13b    | hml
 19a    | hml
 19b    | hml
 25a    | hml
 25b    | hml
 27a    | hml
 27b    | hml
 2a     | hml
 2b     | hml
 30a    | hml
 30b    | hml
 32a    | hml
 32b    | hml
 36a    | hml
 36b    | hml
 3a     | hml
 3b     | hml
 44a    | hml
 44b    | hml
 46a    | hml
 46b    | hml
 47a    | hml
 47b    | hml
 57a    | hml
 57b    | hml
 59a    | hml
 59b    | hml
 61a    | hml
 61b    | hml
 63a    | hml
 63b    | hml
 66a    | hml
 66b    | hml
 67a    | hml
 67b    | hml
 72a    | hml
 72b    | hml
 84a    | hml
 84b    | hml
 87a    | hml
 87b    | hml
 88a    | hml
 88b    | hml
 97a    | hml
 97b    | hml
 99a    | hml
 99b    | hml
 124s   | inv
 124★   | inv
 134s   | inv
 134★   | inv
 107†   | kld
 142†   | kld
 272†   | kld
 70†    | kld
 410a   | lci
 410b   | lci
 410c   | lci
 410d   | lci
 410e   | lci
 410f   | lci
 A-112  | mid
 120†   | mir
 280†   | mir
 87†    | mir
 146†   | mkm
 190†   | mkm
 213†   | mkm
 239†   | mkm
 310†   | mkm
 317z   | mkm
 318z   | mkm
 319z   | mkm
 320z   | mkm
 321z   | mkm
 322z   | mkm
 323z   | mkm
 36†    | mkm
 72†    | mkm
 73†    | mkm
 79†    | mkm
 7†     | mkm
 82†    | mkm
 171†   | ody
 325†   | ody
 72†    | ody
 162†   | ogw
 183a   | ogw
 184a   | ogw
 200★   | ons
 60s    | pcy
 107★   | pls
 133★   | pls
 74★    | pls
 278★   | shm
 265†a  | soi
 265†b  | soi
 265†c  | soi
 265†d  | soi
 265†e  | soi
 33★    | stx
 347★   | thb
 119s   | usg
 130s   | usg
 139s   | usg
 142s   | usg
 163s   | usg
 164s   | usg
 187s   | usg
 100★   | war
 119★   | war
 135★   | war
 13★    | war
 143★   | war
 146★   | war
 150★   | war
 164★   | war
 169★   | war
 180★   | war
 184★   | war
 191★   | war
 1★     | war
 207★   | war
 211★   | war
 217★   | war
 220★   | war
 221★   | war
 227★   | war
 228★   | war
 229★   | war
 230★   | war
 231★   | war
 232★   | war
 233★   | war
 234★   | war
 235★   | war
 236★   | war
 2★     | war
 32★    | war
 37★    | war
 54★    | war
 56★    | war
 61★    | war
 83★    | war
 97★    | war
 230a   | zen
 231a   | zen
 232a   | zen
 233a   | zen
 234a   | zen
 235a   | zen
 236a   | zen
 237a   | zen
 238a   | zen
 239a   | zen
 240a   | zen
 241a   | zen
 242a   | zen
 243a   | zen
 244a   | zen
 245a   | zen
 246a   | zen
 247a   | zen
 248a   | zen
 249a   | zen
(491 rows)



FILTER FOR CARDS
select s.code, s.name, s.type, s.release_date from set s left join card c on
 c.set_code = s.code where s.base_size > 0 GROUP BY s.code HAVING COUNT(c.id) = 0 order by type;
 code |                     name                     |    type     | release_date 
------+----------------------------------------------+-------------+--------------
 mb1  | Mystery Booster                              | masters     | 2019-11-07
 amh1 | Modern Horizons Art Series                   | memorabilia | 2019-06-05
 mkhm | Kaldheim Minigames                           | minigame    | 2021-02-05
 mznr | Zendikar Rising Minigames                    | minigame    | 2020-09-25
 mafr | Adventures in the Forgotten Realms Minigames | minigame    | 2021-07-23
 mstx | Strixhaven: School of Mages Minigames        | minigame    | 2021-04-23
 mmh2 | Modern Horizons 2 Minigames                  | minigame    | 2021-06-18
 plny | Lunar New Year 2018                          | promo       | 2018-02-16
 f18  | Friday Night Magic 2018                      | promo       | 2017-12-27
 pr2  | Magic Player Rewards 2002                    | promo       | 2002-01-01
 l14  | League Tokens 2014                           | token       | 2014-01-01
 l17  | League Tokens 2017                           | token       | 2017-01-01
 l13  | League Tokens 2013                           | token       | 2013-01-01
 l12  | League Tokens 2012                           | token       | 2012-01-01
 l16  | League Tokens 2016                           | token       | 2016-01-01
 l15  | League Tokens 2015                           | token       | 2015-01-01
(16 rows)

select s.code, s.name, s.type, s.release_date from set s left join card c on c.set_code = s.code where s.base_size = 0 GROUP BY s.code HAVING COUNT(c.id) > 1 order by type;
 code |                 name                  |       type       | release_date 
------+---------------------------------------+------------------+--------------
 h2r  | Modern Horizons 2 Timeshifts          | draft_innovation | 2024-06-07
 tmc  | Teenage Mutant Ninja Turtles Eternal  | eternal          | 2026-03-06
 spg  | Special Guests                        | masterpiece      | 2023-11-17
 eos  | Edge of Eternities: Stellar Sights    | masterpiece      | 2025-08-01
 wot  | Wilds of Eldraine: Enchanting Tales   | masterpiece      | 2023-09-08
 fca  | Final Fantasy: Through the Ages       | masterpiece      | 2025-06-13
 otp  | Breaking News                         | masterpiece      | 2024-04-19
 mar  | Marvel Universe                       | masterpiece      | 2025-09-26
 rex  | Jurassic World Collection             | masterpiece      | 2023-11-17
 lmar | Marvel Legends Series Inserts         | promo            | 2025-09-30
 prcq | Regional Championship Qualifiers 2022 | promo            | 2022-10-01
 pw25 | Wizards Play Network 2025             | promo            | 2025-01-01
(12 rows)

card.layout: [
    "adventure", "aftermath", "art_series", "augment", "case", "class", "double_faced_token", "emblem", "flip", "host", "leveler", "meld", "modal_dfc", "mutate", "normal", "planar", "prototype", "reversible_card", "saga", "scheme", "split", "token", "transform", "vanguard"
]

card.isAlternative? : bool - indicates if card is not in main set?

card.variations: str[] - list of card UUIDs with alt printings in SAME SET

card.availability: if contains "paper" keep, otherwise toss 

{
  "artist": "Clint Cearley",
  "artistIds": [
    "03b75350-d5a0-4e3a-b3b4-8d4a5554385b"
  ],
  "availability": [
    "mtgo",
    "paper"
  ],
  "borderColor": "black",
  "colorIdentity": [
    "W"
  ],
  "colors": [
    "W"
  ],
  "convertedManaCost": 7,
  "edhrecRank": 2332,
  "edhrecSaltiness": 0.28,
  "faceConvertedManaCost": 7,
  "faceManaValue": 7,
  "faceName": "Bruna, the Fading Light",
  "finishes": [
    "foil"
  ],
  "flavorText": "She now sees only Emrakul's visions.",
  "foreignData": [],
  "frameEffects": [
    "mooneldrazidfc"
  ],
  "frameVersion": "2015",
  "hasFoil": true,
  "hasNonFoil": false,
  "identifiers": {
    "cardKingdomFoilId": "215241",
    "cardsphereFoilId": "52596",
    "deckboxId": "37481",
    "mcmId": "312684",
    "mcmMetaId": "222994",
    "mtgjsonV4Id": "d7e29b43-cff5-5d48-a56b-303991800b62",
    "mtgoId": "66409",
    "multiverseId": "439322",
    "scryfallCardBackId": "7ca70503-7e97-4db0-99f9-4b9820f879f5",
    "scryfallId": "2b45fb19-450d-40bd-91c7-b5ace4a77f2a",
    "scryfallIllustrationId": "4c8cee4a-a9a4-42eb-9cbf-fcc6c6344d00",
    "scryfallOracleId": "bce7e45d-b2c5-43aa-91a6-3a3c24f30850",
    "tcgplayerProductId": "151636"
  },
  "isReprint": true,
  "isStarter": true,
  "keywords": [
    "Flying",
    "Vigilance"
  ],
  "language": "English",
  "layout": "meld",
  "leadershipSkills": {
    "brawl": false,
    "commander": true,
    "oathbreaker": false
  },
  "legalities": {
    "brawl": "Legal",
    "commander": "Legal",
    "duel": "Legal",
    "gladiator": "Legal",
    "historic": "Legal",
    "legacy": "Legal",
    "modern": "Legal",
    "oathbreaker": "Legal",
    "penny": "Legal",
    "pioneer": "Legal",
    "timeless": "Legal",
    "vintage": "Legal"
  },
  "manaCost": "{5}{W}{W}",
  "manaValue": 7,
  "name": "Bruna, the Fading Light // Brisela, Voice of Nightmares",
  "number": "5",
  "originalText": "When you cast Bruna, the Fading Light, you may return target Angel or Human creature card from your graveyard to the battlefield.\nFlying, vigilance\n(Melds with Gisela, the Broken Blade.)",
  "otherFaceIds": [
    "b3dc9b70-fe64-5370-841b-5282d00fb1a9"
  ],
  "power": "5",
  "printings": [
    "EMN",
    "INR",
    "PEMN",
    "SIR",
    "SLD",
    "V17"
  ],
  "purchaseUrls": {
    "cardKingdomFoil": "https://mtgjson.com/links/81def4ea6ff04775",
    "cardmarket": "https://mtgjson.com/links/517eda6703caf95c",
    "tcgplayer": "https://mtgjson.com/links/1e061e31f4b71707"
  },
  "rarity": "mythic",
  "rulings": [
    {
      "date": "2016-07-13",
      "text": "For more information on meld cards, see the Eldritch Moon mechanics article (https://magic.wizards.com/en/articles/archive/feature/eldritch-moon-mechanics-2016-06-27)."
    }
  ],
  "securityStamp": "oval",
  "setCode": "V17",
  "side": "a",
  "sourceProducts": {
    "foil": [
      "295c7d1a-c80b-5f09-a032-79d8e54f8453"
    ]
  },
  "subtypes": [
    "Angel",
    "Horror"
  ],
  "supertypes": [
    "Legendary"
  ],
  "text": "When you cast this spell, you may return target Angel or Human creature card from your graveyard to the battlefield.\nFlying, vigilance\n(Melds with Gisela, the Broken Blade.)",
  "toughness": "7",
  "type": "Legendary Creature — Angel Horror",
  "types": [
    "Creature"
  ],
  "uuid": "3d12f898-11fb-52c3-bbed-e76c8a9f199d"
}
{
  "artist": "Clint Cearley",
  "artistIds": [
    "03b75350-d5a0-4e3a-b3b4-8d4a5554385b"
  ],
  "availability": [
    "mtgo",
    "paper"
  ],
  "borderColor": "black",
  "colorIdentity": [
    "W"
  ],
  "colors": [],
  "convertedManaCost": 11,
  "faceConvertedManaCost": 11,
  "faceManaValue": 11,
  "faceName": "Brisela, Voice of Nightmares",
  "finishes": [
    "foil"
  ],
  "flavorText": "Upon discovering what had become of her sisters, Sigarda could only weep.",
  "foreignData": [],
  "frameEffects": [
    "mooneldrazidfc"
  ],
  "frameVersion": "2015",
  "hasFoil": true,
  "hasNonFoil": false,
  "identifiers": {
    "mtgjsonV4Id": "458663a7-b298-5d84-a441-49c06608a536",
    "multiverseId": "439323",
    "scryfallCardBackId": "0aeebaf5-8c7d-4636-9e82-8c27447861f7",
    "scryfallId": "eba8bb03-6093-4e2b-99a2-a3fc5d8eb659",
    "scryfallIllustrationId": "9528e065-5297-4d91-bf75-3c175b54f0d4",
    "scryfallOracleId": "b23587e0-9fb7-492e-8bb4-f218e8e4ce6c"
  },
  "isReprint": true,
  "isStarter": true,
  "keywords": [
    "First strike",
    "Flying",
    "Lifelink",
    "Vigilance"
  ],
  "language": "English",
  "layout": "meld",
  "legalities": {
    "brawl": "Legal",
    "commander": "Legal",
    "duel": "Legal",
    "gladiator": "Legal",
    "historic": "Legal",
    "legacy": "Legal",
    "modern": "Legal",
    "oathbreaker": "Legal",
    "pioneer": "Legal",
    "timeless": "Legal",
    "vintage": "Legal"
  },
  "manaValue": 11,
  "name": "Brisela, Voice of Nightmares",
  "number": "5b",
  "originalText": "Flying, first strike, vigilance, lifelink\nYour opponents can't cast spells with converted mana cost 3 or less.",
  "otherFaceIds": [
    "3d12f898-11fb-52c3-bbed-e76c8a9f199d",
    "f0c70297-7170-5d45-a279-3685f9f0e3ad"
  ],
  "power": "9",
  "printings": [
    "EMN",
    "INR",
    "PEMN",
    "SIR",
    "SLD",
    "V17"
  ],
  "purchaseUrls": {},
  "rarity": "mythic",
  "rulings": [
    {
      "date": "2016-07-13",
      "text": "For more information on meld cards, see the Eldritch Moon mechanics article (https://magic.wizards.com/en/articles/archive/feature/eldritch-moon-mechanics-2016-06-27)."
    }
  ],
  "setCode": "V17",
  "side": "b",
  "subtypes": [
    "Eldrazi",
    "Angel"
  ],
  "supertypes": [
    "Legendary"
  ],
  "text": "Flying, first strike, vigilance, lifelink\nYour opponents can't cast spells with mana value 3 or less.",
  "toughness": "10",
  "type": "Legendary Creature — Eldrazi Angel",
  "types": [
    "Creature"
  ],
  "uuid": "b3dc9b70-fe64-5370-841b-5282d00fb1a9"
}

+--------------------------------+
+--------------------------------+
| SETS WITH CARDS WITHOUT PRICES |
+--------------------------------+
+--------------------------------+
i_want_my_mtg=# select set_code, count(*) from card where id not in(select card_id from price) group by set_code order by set_code;
 set_code | count 
----------+-------
 10e      |     1
 2ed      |     1
 2x2      |   160
 30a      |    32
 3ed      |     1
 40k      |     4
 4bb      |   378 *
 4ed      |     3
 5ed      |     7
 6ed      |     3
 7ed      |     4
 acr      |    96
 arn      |     3
 atq      |     1
 bchr     |   125 *
 brr      |    23
 ced      |     1
 cei      |     1
 clb      |    86
 cmm      |   174
 cmr      |   101
 dci      |     1
 ddf      |     1
 dmc      |    20
 ecl      |     9
 eld      |     1
 fbb      |   307 *
 fic      |    27
 fin      |     9
 frf      |     6
 gpt      |     1
 hho      |     1
 inv      |     4
 itp      |    43
 jp1      |     5
 lci      |     1
 lea      |     1
 leb      |     1
 leg      |     4
 ltc      |    33
 ltr      |    21
 m3c      |    12
 mat      |    50
 mgb      |    10
 mh3      |    24
 mir      |     3
 mkm      |     6
 mom      |     4
 mul      |    91
 neo      |     1
 o90p     |    10 *
 oafc     |     1
 oc21     |     1
 ody      |     2
 ogw      |     1
 olep     |    83 *
 olgc     |    27 *
 omic     |     1
 onc      |     1
 ons      |     1
 ovnt     |    35 *
 ovoc     |     1
 p09      |     4
 p10      |     4
 p11      |     2
 p30a     |     2
 p30m     |     1
 p30t     |     2
 p9ed     |     1
 pal99    |     1
 pcel     |     9 *
 pcy      |     1
 pdom     |     1
 pewk     |     4
 pfin     |     1
 pgpx     |     1
 ph17     |     3
 ph18     |     5
 ph19     |     7
 ph20     |     3
 ph21     |     4
 ph22     |     5
 ph23     |     1
 phel     |     1
 phtr     |     3
 phuk     |    60 *
 pip      |     3
 pjas     |     6
 pjjt     |    12 *
 pjsc     |     2
 pjse     |     1
 pkhm     |     2
 plg21    |     2
 plg24    |     4
 plst     |     7
 pm11     |     2
 pmda     |     4
 pmei     |    50
 pmps08   |     1
 pncc     |     1
 por      |    28
 ppro     |     1
 pred     |     1
 proe     |     1
 ps11     |   224 *
 psal     |   720 *
 pspl     |     3
 pssc     |    10
 psus     |     1
 psvc     |     3
 ptor     |     2
 punk     |    52
 purl     |     4
 pw23     |     1
 pw25     |     4
 pwar     |     4
 pwcs     |    39
 pwwk     |     2
 pza      |     1
 pzen     |     2
 ren      |   122 *
 rex      |     1
 rin      |    69 *
 rqs      |    65 *
 rvr      |    21
 scd      |     5
 sld      |    71
 slp      |     5
 snc      |    11
 spg      |     1
 stx      |     1
 sum      |   303 *
 tdm      |     1
 tla      |     5
 tle      |    31
 tmc      |     7
 tmt      |    16
 unk      |   464 *
 usg      |     5
 vow      |     5
 wc02     |     6
 wc03     |     1
 wc04     |     1
 who      |     5
(144 rows)
* entire set


 -- counts per set: total cards, cards with >=1 price row, cards with no price rows
 SELECT
   c.set_code,
   COUNT(*) AS total_cards,
   COUNT(DISTINCT p.card_id) AS cards_with_price,
   COUNT(*) - COUNT(DISTINCT p.card_id) AS cards_without_price
 FROM card c
 LEFT JOIN price p ON p.card_id = c.id
 GROUP BY c.set_code
 ORDER BY cards_without_price DESC, c.set_code;
 set_code | total_cards | cards_with_price | cards_without_price 
----------+-------------+------------------+---------------------
 mgb      |          10 |                0 |                  10
 pjjt     |          12 |                0 |                  12
 pjas     |           6 |                0 |                   6
 jp1      |           5 |                0 |                   5
 ph18     |           5 |                0 |                   5
 ph22     |           5 |                0 |                   5
 o90p     |          10 |                0 |                  10
 pssc     |          10 |                0 |                  10
 ph19     |           7 |                0 |                   7
 pcel     |           9 |                0 |                   9
 psal     |         720 |                0 |                 720
 4bb      |         378 |                0 |                 378
 fbb      |         307 |                0 |                 307
 bchr     |         125 |                0 |                 125
 olep     |          83 |                0 |                  83
 ph17     |           3 |                0 |                   3
 pmda     |           4 |                0 |                   4
 ph20     |           3 |                0 |                   3
 psvc     |           3 |                0 |                   3
 phtr     |           3 |                0 |                   3
 pred     |           1 |                0 |                   1
 pza      |           1 |                0 |                   1
 p30t     |           2 |                0 |                   2
 pjsc     |           2 |                0 |                   2
 rin      |          69 |                0 |                  69
 rqs      |          65 |                0 |                  65
 olgc     |          27 |                0 |                  27
 phuk     |          60 |                0 |                  60
 ovnt     |          35 |                0 |                  35
 punk     |          52 |                0 |                  52
 ren      |         122 |                0 |                 122
 ps11     |         224 |                0 |                 224
 sum      |         306 |                3 |                 303
 unk      |         467 |                3 |                 464
 cmm      |        1067 |              893 |                 174
 2x2      |         579 |              419 |                 160
 cmr      |         718 |              617 |                 101
 acr      |         309 |              213 |                  96
 mul      |         260 |              170 |                  90
 sld      |        2247 |             2160 |                  87
 clb      |         936 |              850 |                  86
 mat      |         230 |              180 |                  50
 pmei     |          80 |               30 |                  50
 itp      |          67 |               24 |                  43
 pwcs     |          42 |                3 |                  39
 ltc      |         591 |              558 |                  33
 30a      |         594 |              563 |                  31
 tle      |         318 |              287 |                  31
 por      |         257 |              229 |                  28
 fic      |         486 |              459 |                  27
 mh3      |         524 |              500 |                  24
 brr      |         189 |              166 |                  23
 ltr      |         854 |              833 |                  21
 rvr      |         531 |              510 |                  21
 dmc      |         240 |              220 |                  20
 tmt      |          20 |                4 |                  16
 m3c      |         398 |              386 |                  12
 snc      |         469 |              457 |                  12
 fin      |         590 |              581 |                   9
 ecl      |          33 |               25 |                   8
 5ed      |         460 |              453 |                   7
 plst     |        4985 |             4978 |                   7
 tmc      |          12 |                5 |                   7
 wc02     |         143 |              136 |                   7
 frf      |         191 |              185 |                   6
 mkm      |         451 |              445 |                   6
 scd      |         352 |              347 |                   5
 slp      |          46 |               41 |                   5
 usg      |         357 |              352 |                   5
 vow      |         412 |              407 |                   5
 who      |        1178 |             1173 |                   5
 40k      |         617 |              613 |                   4
 7ed      |         708 |              704 |                   4
 inv      |         354 |              350 |                   4
 leg      |         310 |              306 |                   4
 mom      |         387 |              383 |                   4
 p09      |          13 |                9 |                   4
 p10      |          13 |                9 |                   4
 pewk     |           8 |                4 |                   4
 ph21     |           4 |                0 |                   4
 plg24    |           5 |                1 |                   4
 purl     |          15 |               11 |                   4
 pw25     |          17 |               13 |                   4
 pwar     |         176 |              172 |                   4
 tla      |         394 |              390 |                   4
 4ed      |         379 |              376 |                   3
 6ed      |         351 |              348 |                   3
 arn      |          92 |               89 |                   3
 mir      |         353 |              350 |                   3
 pip      |        1068 |             1065 |                   3
 pspl     |           7 |                4 |                   3
 ody      |         353 |              351 |                   2
 p11      |           7 |                5 |                   2
 p30a     |          30 |               28 |                   2
 pkhm     |         158 |              156 |                   2
 plg21    |          11 |                9 |                   2
 pm11     |           6 |                4 |                   2
 ptor     |           3 |                1 |                   2
 pwwk     |           6 |                4 |                   2
 pzen     |           5 |                3 |                   2
 10e      |         510 |              509 |                   1
 2ed      |         302 |              301 |                   1
 3ed      |         306 |              305 |                   1
 atq      |         102 |              101 |                   1
 ced      |         302 |              301 |                   1
 cei      |         302 |              301 |                   1
 dci      |          80 |               79 |                   1
 ddf      |          79 |               78 |                   1
 dft      |         553 |              552 |                   1
 eld      |         398 |              397 |                   1
 gpt      |         167 |              166 |                   1
 hho      |          21 |               20 |                   1
 lci      |         415 |              414 |                   1
 lea      |         295 |              294 |                   1
 leb      |         302 |              301 |                   1
 neo      |         514 |              513 |                   1
 oafc     |           4 |                3 |                   1
 oc21     |           5 |                4 |                   1
 ogw      |         187 |              186 |                   1
 omic     |           2 |                1 |                   1
 ons      |         351 |              350 |                   1
 ovoc     |           2 |                1 |                   1
 p30m     |           5 |                4 |                   1
 p9ed     |           2 |                1 |                   1
 pal99    |          10 |                9 |                   1
 pcy      |         144 |              143 |                   1
 pdom     |         118 |              117 |                   1
 pfin     |          94 |               93 |                   1
 pgpx     |          20 |               19 |                   1
 ph23     |           1 |                0 |                   1
 phel     |           5 |                4 |                   1
 pjse     |           8 |                7 |                   1
 pmps08   |           6 |                5 |                   1
 ppro     |          17 |               16 |                   1
 proe     |           4 |                3 |                   1
 psus     |          18 |               17 |                   1
 pw23     |          11 |               10 |                   1
 rex      |          45 |               44 |                   1
 spg      |         134 |              133 |                   1
 stx      |         383 |              382 |                   1
 tdm      |         426 |              425 |                   1
 wc04     |          93 |               92 |                   1
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 ----------------------------------------------------------------------
 2xm      |         384 |              384 |                   0
 5dn      |         165 |              165 |                   0
 8ed      |         710 |              710 |                   0
 9ed      |         709 |              709 |                   0
 a25      |         249 |              249 |                   0
 aer      |         197 |              197 |                   0
 afc      |         331 |              331 |                   0
 afr      |         402 |              402 |                   0
 akh      |         287 |              287 |                   0
 ala      |         250 |              250 |                   0
 all      |         199 |              199 |                   0
 apc      |         143 |              143 |                   0
 arb      |         145 |              145 |                   0
 arc      |         150 |              150 |                   0
 ath      |          85 |               85 |                   0
 avr      |         244 |              244 |                   0
 bbd      |         256 |              256 |                   0
 bfz      |         299 |              299 |                   0
 big      |          95 |               95 |                   0
 blb      |         397 |              397 |                   0
 blc      |         356 |              356 |                   0
 bng      |         165 |              165 |                   0
 bok      |         165 |              165 |                   0
 bot      |          29 |               29 |                   0
 brb      |         136 |              136 |                   0
 brc      |         209 |              209 |                   0
 bro      |         384 |              384 |                   0
 btd      |          90 |               90 |                   0
 c13      |         356 |              356 |                   0
 c14      |         337 |              337 |                   0
 c15      |         342 |              342 |                   0
 c16      |         351 |              351 |                   0
 c17      |         309 |              309 |                   0
 c18      |         307 |              307 |                   0
 c19      |         302 |              302 |                   0
 c20      |         322 |              322 |                   0
 c21      |         409 |              409 |                   0
 cc1      |           8 |                8 |                   0
 cc2      |           8 |                8 |                   0
 chk      |         307 |              307 |                   0
 chr      |         125 |              125 |                   0
 clu      |         284 |              284 |                   0
 cm1      |          18 |               18 |                   0
 cm2      |         312 |              312 |                   0
 cma      |         320 |              320 |                   0
 cmb1     |         121 |              121 |                   0
 cmb2     |         121 |              121 |                   0
 cmd      |         318 |              318 |                   0
 cn2      |         222 |              222 |                   0
 cns      |         210 |              210 |                   0
 con      |         145 |              145 |                   0
 cp1      |           6 |                6 |                   0
 cp2      |           6 |                6 |                   0
 cp3      |           6 |                6 |                   0
 csp      |         155 |              155 |                   0
 cst      |          62 |               62 |                   0
 dbl      |         535 |              535 |                   0
 dd1      |          62 |               62 |                   0
 dd2      |          64 |               64 |                   0
 ddc      |          62 |               62 |                   0
 ddd      |          63 |               63 |                   0
 dde      |          71 |               71 |                   0
 ddg      |          81 |               81 |                   0
 ddh      |          80 |               80 |                   0
 ddi      |          77 |               77 |                   0
 ddj      |          90 |               90 |                   0
 ddk      |          80 |               80 |                   0
 ddl      |          81 |               81 |                   0
 ddm      |          88 |               88 |                   0
 ddn      |          81 |               81 |                   0
 ddo      |          65 |               65 |                   0
 ddp      |          75 |               75 |                   0
 ddq      |          76 |               76 |                   0
 ddr      |          70 |               70 |                   0
 dds      |          65 |               65 |                   0
 ddt      |          63 |               63 |                   0
 ddu      |          76 |               76 |                   0
 dgm      |         156 |              156 |                   0
 dis      |         180 |              180 |                   0
 dka      |         158 |              158 |                   0
 dkm      |          58 |               58 |                   0
 dmr      |         457 |              457 |                   0
 dmu      |         436 |              436 |                   0
 dom      |         280 |              280 |                   0
 dpa      |         113 |              113 |                   0
 drb      |          15 |               15 |                   0
 drc      |         184 |              184 |                   0
 drk      |         122 |              122 |                   0
 dsc      |         373 |              373 |                   0
 dsk      |         417 |              417 |                   0
 dst      |         165 |              165 |                   0
 dtk      |         264 |              264 |                   0
 dvd      |          62 |               62 |                   0
 e01      |         106 |              106 |                   0
 e02      |          47 |               47 |                   0
 ema      |         249 |              249 |                   0
 emn      |         205 |              205 |                   0
 eoc      |         191 |              191 |                   0
 eoe      |         399 |              399 |                   0
 eos      |         180 |              180 |                   0
 eve      |         180 |              180 |                   0
 evg      |          62 |               62 |                   0
 exo      |         143 |              143 |                   0
 exp      |          45 |               45 |                   0
 f01      |           7 |                7 |                   0
 f02      |          12 |               12 |                   0
 f03      |          13 |               13 |                   0
 f04      |          12 |               12 |                   0
 f05      |          12 |               12 |                   0
 f06      |          12 |               12 |                   0
 f07      |          12 |               12 |                   0
 f08      |          12 |               12 |                   0
 f09      |          12 |               12 |                   0
 f10      |          12 |               12 |                   0
 f11      |          12 |               12 |                   0
 f12      |          12 |               12 |                   0
 f13      |          12 |               12 |                   0
 f14      |          12 |               12 |                   0
 f15      |          12 |               12 |                   0
 f16      |          12 |               12 |                   0
 f17      |           9 |                9 |                   0
 fca      |          64 |               64 |                   0
 fdc      |           3 |                3 |                   0
 fdn      |         730 |              730 |                   0
 fem      |         187 |              187 |                   0
 fnm      |          11 |               11 |                   0
 fut      |         180 |              180 |                   0
 g00      |           2 |                2 |                   0
 g01      |           2 |                2 |                   0
 g02      |           2 |                2 |                   0
 g03      |           3 |                3 |                   0
 g04      |           6 |                6 |                   0
 g05      |           4 |                4 |                   0
 g06      |           4 |                4 |                   0
 g07      |           5 |                5 |                   0
 g08      |           5 |                5 |                   0
 g09      |          10 |               10 |                   0
 g10      |           8 |                8 |                   0
 g11      |           8 |                8 |                   0
 g17      |           5 |                5 |                   0
 g18      |           5 |                5 |                   0
 g99      |           1 |                1 |                   0
 gdy      |           9 |                9 |                   0
 gk1      |         127 |              127 |                   0
 gk2      |         133 |              133 |                   0
 gn2      |          64 |               64 |                   0
 gn3      |         135 |              135 |                   0
 gnt      |          68 |               68 |                   0
 grn      |         273 |              273 |                   0
 gs1      |          40 |               40 |                   0
 gtc      |         249 |              249 |                   0
 gvl      |          63 |               63 |                   0
 h09      |          41 |               41 |                   0
 h17      |           3 |                3 |                   0
 h1r      |          40 |               40 |                   0
 h2r      |          16 |               16 |                   0
 hml      |         140 |              140 |                   0
 hop      |         169 |              169 |                   0
 hou      |         209 |              209 |                   0
 ice      |         383 |              383 |                   0
 iko      |         387 |              387 |                   0
 ima      |         249 |              249 |                   0
 inr      |         492 |              492 |                   0
 isd      |         264 |              264 |                   0
 j12      |           8 |                8 |                   0
 j13      |           8 |                8 |                   0
 j14      |          14 |               14 |                   0
 j15      |           8 |                8 |                   0
 j16      |           8 |                8 |                   0
 j17      |           9 |                9 |                   0
 j18      |           8 |                8 |                   0
 j19      |           8 |                8 |                   0
 j20      |          10 |               10 |                   0
 j22      |         835 |              835 |                   0
 j25      |         779 |              779 |                   0
 jgp      |           3 |                3 |                   0
 jmp      |         496 |              496 |                   0
 jou      |         165 |              165 |                   0
 jud      |         143 |              143 |                   0
 jvc      |          62 |               62 |                   0
 khc      |         119 |              119 |                   0
 khm      |         407 |              407 |                   0
 kld      |         278 |              278 |                   0
 ktk      |         269 |              269 |                   0
 lcc      |         370 |              370 |                   0
 lgn      |         145 |              145 |                   0
 lmar     |           4 |                4 |                   0
 lrw      |         301 |              301 |                   0
 m10      |         249 |              249 |                   0
 m11      |         249 |              249 |                   0
 m12      |         249 |              249 |                   0
 m13      |         249 |              249 |                   0
 m14      |         249 |              249 |                   0
 m15      |         284 |              284 |                   0
 m19      |         314 |              314 |                   0
 m20      |         345 |              345 |                   0
 m21      |         397 |              397 |                   0
 mar      |          40 |               40 |                   0
 mb2      |         384 |              384 |                   0
 mbs      |         155 |              155 |                   0
 md1      |          26 |               26 |                   0
 med      |          24 |               24 |                   0
 mh1      |         255 |              255 |                   0
 mh2      |         492 |              492 |                   0
 mic      |         187 |              187 |                   0
 mid      |         391 |              391 |                   0
 mkc      |         358 |              358 |                   0
 mm2      |         249 |              249 |                   0
 mm3      |         249 |              249 |                   0
 mma      |         229 |              229 |                   0
 mmq      |         350 |              350 |                   0
 moc      |         450 |              450 |                   0
 mor      |         150 |              150 |                   0
 mp2      |          54 |               54 |                   0
 mpr      |           1 |                1 |                   0
 mps      |          54 |               54 |                   0
 mrd      |         306 |              306 |                   0
 ncc      |         447 |              447 |                   0
 nec      |         179 |              179 |                   0
 nem      |         143 |              143 |                   0
 nph      |         175 |              175 |                   0
 oarc     |          45 |               45 |                   0
 oc13     |          15 |               15 |                   0
 oc14     |           5 |                5 |                   0
 oc15     |           5 |                5 |                   0
 oc16     |           5 |                5 |                   0
 oc17     |           4 |                4 |                   0
 oc18     |           4 |                4 |                   0
 oc19     |           4 |                4 |                   0
 oc20     |           5 |                5 |                   0
 ocm1     |          10 |               10 |                   0
 ocmd     |          15 |               15 |                   0
 oe01     |          20 |               20 |                   0
 ohop     |          40 |               40 |                   0
 onc      |         174 |              174 |                   0
 one      |         479 |              479 |                   0
 opc2     |          40 |               40 |                   0
 opca     |          86 |               86 |                   0
 ori      |         288 |              288 |                   0
 otc      |         342 |              342 |                   0
 otj      |         374 |              374 |                   0
 otp      |          80 |               80 |                   0
 p02      |         165 |              165 |                   0
 p03      |           1 |                1 |                   0
 p04      |           1 |                1 |                   0
 p05      |           6 |                6 |                   0
 p06      |           7 |                7 |                   0
 p07      |           7 |                7 |                   0
 p08      |           7 |                7 |                   0
 p10e     |           3 |                3 |                   0
 p15a     |           2 |                2 |                   0
 p22      |          10 |               10 |                   0
 p23      |          10 |               10 |                   0
 p2hg     |           1 |                1 |                   0
 p30h     |          10 |               10 |                   0
 p5dn     |           1 |                1 |                   0
 p8ed     |           1 |                1 |                   0
 paer     |          65 |               65 |                   0
 pafr     |         241 |              241 |                   0
 pakh     |          77 |               77 |                   0
 pal00    |          11 |               11 |                   0
 pal01    |          12 |               12 |                   0
 pal02    |           5 |                5 |                   0
 pal03    |           8 |                8 |                   0
 pal04    |          14 |               14 |                   0
 pal05    |           8 |                8 |                   0
 pal06    |           9 |                9 |                   0
 pala     |           2 |                2 |                   0
 palp     |          15 |               15 |                   0
 papc     |           1 |                1 |                   0
 parb     |           3 |                3 |                   0
 parl     |           7 |                7 |                   0
 pavr     |           6 |                6 |                   0
 pbbd     |          22 |               22 |                   0
 pbfz     |          90 |               90 |                   0
 pbig     |           5 |                5 |                   0
 pblb     |         160 |              160 |                   0
 pbng     |           9 |                9 |                   0
 pbok     |           2 |                2 |                   0
 pbro     |         166 |              166 |                   0
 pc2      |         156 |              156 |                   0
 pca      |         156 |              156 |                   0
 pcbb     |           5 |                5 |                   0
 pchk     |           1 |                1 |                   0
 pclb     |         104 |              104 |                   0
 pcmd     |           5 |                5 |                   0
 pcmp     |          12 |               12 |                   0
 pcmr     |           6 |                6 |                   0
 pcns     |           1 |                1 |                   0
 pcon     |           2 |                2 |                   0
 pcsp     |           1 |                1 |                   0
 pd2      |          34 |               34 |                   0
 pd3      |          30 |               30 |                   0
 pdft     |         160 |              160 |                   0
 pdgm     |           6 |                6 |                   0
 pdis     |           2 |                2 |                   0
 pdka     |           5 |                5 |                   0
 pdmu     |         161 |              161 |                   0
 pdp10    |           2 |                2 |                   0
 pdp12    |           3 |                3 |                   0
 pdp13    |           3 |                3 |                   0
 pdp14    |           3 |                3 |                   0
 pdp15    |           2 |                2 |                   0
 pdrc     |           1 |                1 |                   0
 pdsk     |         160 |              160 |                   0
 pdst     |           1 |                1 |                   0
 pdtk     |          51 |               51 |                   0
 pdtp     |           1 |                1 |                   0
 peld     |         138 |              138 |                   0
 pelp     |          15 |               15 |                   0
 pemn     |          74 |               74 |                   0
 peoe     |         160 |              160 |                   0
 peve     |           2 |                2 |                   0
 pexo     |           1 |                1 |                   0
 pf19     |           7 |                7 |                   0
 pf20     |           6 |                6 |                   0
 pf23     |           4 |                4 |                   0
 pf24     |           2 |                2 |                   0
 pf25     |          19 |               19 |                   0
 pfdn     |          93 |               93 |                   0
 pfrf     |          43 |               43 |                   0
 pfut     |           2 |                2 |                   0
 pgpt     |           2 |                2 |                   0
 pgrn     |          84 |               84 |                   0
 pgru     |           5 |                5 |                   0
 pgtc     |          10 |               10 |                   0
 phop     |           1 |                1 |                   0
 phou     |          62 |               62 |                   0
 phpr     |           5 |                5 |                   0
 pidw     |          17 |               17 |                   0
 piko     |         137 |              137 |                   0
 pinv     |           1 |                1 |                   0
 pisd     |           5 |                5 |                   0
 pj21     |          10 |               10 |                   0
 pjou     |          10 |               10 |                   0
 pjud     |           1 |                1 |                   0
 pkld     |          83 |               83 |                   0
 pktk     |          56 |               56 |                   0
 pl21     |           5 |                5 |                   0
 pl22     |           5 |                5 |                   0
 pl23     |           5 |                5 |                   0
 pl24     |           6 |                6 |                   0
 pl25     |           5 |                5 |                   0
 plc      |         165 |              165 |                   0
 plci     |         136 |              136 |                   0
 plg20    |           2 |                2 |                   0
 plg22    |           2 |                2 |                   0
 plg25    |           2 |                2 |                   0
 plgm     |           2 |                2 |                   0
 plgn     |           1 |                1 |                   0
 plrw     |           3 |                3 |                   0
 pls      |         146 |              146 |                   0
 pltc     |           4 |                4 |                   0
 pltr     |          86 |               86 |                   0
 pm10     |           3 |                3 |                   0
 pm12     |           3 |                3 |                   0
 pm13     |           6 |                6 |                   0
 pm14     |           6 |                6 |                   0
 pm15     |          14 |               14 |                   0
 pm19     |          95 |               95 |                   0
 pm20     |         144 |              144 |                   0
 pm21     |         137 |              137 |                   0
 pmat     |           8 |                8 |                   0
 pmbs     |           4 |                4 |                   0
 pmh1     |           2 |                2 |                   0
 pmh2     |          86 |               86 |                   0
 pmh3     |          85 |               85 |                   0
 pmic     |           1 |                1 |                   0
 pmid     |         155 |              155 |                   0
 pmkm     |         180 |              180 |                   0
 pmmq     |           1 |                1 |                   0
 pmom     |         134 |              134 |                   0
 pmor     |           2 |                2 |                   0
 pmps     |          20 |               20 |                   0
 pmps06   |           5 |                5 |                   0
 pmps07   |           5 |                5 |                   0
 pmps09   |           5 |                5 |                   0
 pmps10   |           5 |                5 |                   0
 pmps11   |           5 |                5 |                   0
 pmrd     |           1 |                1 |                   0
 pnat     |           1 |                1 |                   0
 pncc     |          75 |               75 |                   0
 pnem     |           1 |                1 |                   0
 pneo     |         148 |              148 |                   0
 pnph     |           4 |                4 |                   0
 pody     |           1 |                1 |                   0
 pogw     |          65 |               65 |                   0
 pone     |         160 |              160 |                   0
 pons     |           1 |                1 |                   0
 pori     |          54 |               54 |                   0
 potj     |         160 |              160 |                   0
 ppc1     |           1 |                1 |                   0
 ppcy     |           1 |                1 |                   0
 pplc     |           2 |                2 |                   0
 ppls     |           1 |                1 |                   0
 ppp1     |           5 |                5 |                   0
 pptk     |           2 |                2 |                   0
 pr23     |           3 |                3 |                   0
 prav     |           2 |                2 |                   0
 prcq     |           3 |                3 |                   0
 prix     |          98 |               98 |                   0
 prna     |          81 |               81 |                   0
 prtr     |          10 |               10 |                   0
 prw2     |          10 |               10 |                   0
 prwk     |          10 |               10 |                   0
 ps14     |           6 |                6 |                   0
 ps15     |           5 |                5 |                   0
 ps16     |           5 |                5 |                   0
 ps17     |           6 |                6 |                   0
 ps18     |           5 |                5 |                   0
 ps19     |           5 |                5 |                   0
 pscg     |           1 |                1 |                   0
 psdc     |           5 |                5 |                   0
 pshm     |           2 |                2 |                   0
 psnc     |         161 |              161 |                   0
 psoi     |          90 |               90 |                   0
 psok     |           2 |                2 |                   0
 psom     |           4 |                4 |                   0
 pspm     |          68 |               68 |                   0
 pss1     |           5 |                5 |                   0
 pss2     |           5 |                5 |                   0
 pss3     |           5 |                5 |                   0
 pss4     |           5 |                5 |                   0
 pss5     |           2 |                2 |                   0
 psth     |           1 |                1 |                   0
 pstx     |         164 |              164 |                   0
 ptc      |         307 |              307 |                   0
 ptdm     |         160 |              160 |                   0
 ptg      |           3 |                3 |                   0
 pthb     |         137 |              137 |                   0
 pths     |          10 |               10 |                   0
 ptk      |         180 |              180 |                   0
 ptkdf    |           4 |                4 |                   0
 ptmp     |           1 |                1 |                   0
 ptsp     |           3 |                3 |                   0
 ptsr     |           3 |                3 |                   0
 puds     |           1 |                1 |                   0
 pulg     |           2 |                2 |                   0
 puma     |          40 |               40 |                   0
 punh     |           1 |                1 |                   0
 pusg     |           1 |                1 |                   0
 pust     |           1 |                1 |                   0
 pvan     |          32 |               32 |                   0
 pvow     |         121 |              121 |                   0
 pw11     |           3 |                3 |                   0
 pw12     |           3 |                3 |                   0
 pw21     |           6 |                6 |                   0
 pw22     |           6 |                6 |                   0
 pw24     |          18 |               18 |                   0
 pwoe     |         160 |              160 |                   0
 pwor     |           2 |                2 |                   0
 pwos     |           1 |                1 |                   0
 pxln     |         120 |              120 |                   0
 pxtc     |          10 |               10 |                   0
 pznr     |         153 |              153 |                   0
 q06      |          10 |               10 |                   0
 rav      |         306 |              306 |                   0
 rfin     |           2 |                2 |                   0
 rix      |         205 |              205 |                   0
 rna      |         273 |              273 |                   0
 roe      |         248 |              248 |                   0
 rtr      |         274 |              274 |                   0
 s00      |          20 |               20 |                   0
 s99      |         173 |              173 |                   0
 scg      |         143 |              143 |                   0
 sch      |          44 |               44 |                   0
 shm      |         302 |              302 |                   0
 slc      |          84 |               84 |                   0
 slu      |          16 |               16 |                   0
 slx      |          30 |               30 |                   0
 soi      |         302 |              302 |                   0
 sok      |         165 |              165 |                   0
 som      |         249 |              249 |                   0
 spe      |          26 |               26 |                   0
 spm      |         286 |              286 |                   0
 ss1      |           8 |                8 |                   0
 ss2      |           8 |                8 |                   0
 ss3      |           8 |                8 |                   0
 sta      |         126 |              126 |                   0
 sth      |         143 |              143 |                   0
 sunf     |          48 |               48 |                   0
 tbth     |          10 |               10 |                   0
 tdag     |           8 |                8 |                   0
 tdc      |         413 |              413 |                   0
 tfth     |          10 |               10 |                   0
 thb      |         358 |              358 |                   0
 thp1     |           7 |                7 |                   0
 thp2     |           7 |                7 |                   0
 thp3     |           7 |                7 |                   0
 ths      |         249 |              249 |                   0
 tmp      |         350 |              350 |                   0
 tor      |         143 |              143 |                   0
 tsb      |         121 |              121 |                   0
 tsp      |         301 |              301 |                   0
 tsr      |         411 |              411 |                   0
 uds      |         143 |              143 |                   0
 ugin     |          26 |               26 |                   0
 ugl      |          88 |               88 |                   0
 ulg      |         143 |              143 |                   0
 ulst     |          62 |               62 |                   0
 uma      |         254 |              254 |                   0
 und      |          96 |               96 |                   0
 unf      |         638 |              638 |                   0
 unh      |         168 |              168 |                   0
 ust      |         268 |              268 |                   0
 v09      |          15 |               15 |                   0
 v10      |          15 |               15 |                   0
 v11      |          15 |               15 |                   0
 v12      |          15 |               15 |                   0
 v13      |          20 |               20 |                   0
 v14      |          15 |               15 |                   0
 v15      |          15 |               15 |                   0
 v16      |          15 |               15 |                   0
 v17      |          15 |               15 |                   0
 vis      |         167 |              167 |                   0
 voc      |         188 |              188 |                   0
 w16      |          16 |               16 |                   0
 w17      |          30 |               30 |                   0
 war      |         311 |              311 |                   0
 wc00     |         107 |              107 |                   0
 wc01     |         128 |              128 |                   0
 wc03     |         132 |              132 |                   0
 wc97     |         121 |              121 |                   0
 wc98     |         107 |              107 |                   0
 wc99     |         100 |              100 |                   0
 wmc      |           5 |                5 |                   0
 woc      |         173 |              173 |                   0
 woe      |         381 |              381 |                   0
 wot      |         103 |              103 |                   0
 wth      |         167 |              167 |                   0
 wwk      |         145 |              145 |                   0
 xln      |         289 |              289 |                   0
 zen      |         269 |              269 |                   0
 znc      |         142 |              142 |                   0
 zne      |          30 |               30 |                   0
 znr      |         391 |              391 |                   0
(678 rows)


i_want_my_mtg=# SELECT
  c.set_code,
  COUNT(*) AS total_cards,
  COUNT(DISTINCT p.card_id) AS cards_with_price,
  COUNT(*) - COUNT(DISTINCT p.card_id) AS cards_without_price,
  ROUND(100.0 * COUNT(DISTINCT p.card_id) / NULLIF(COUNT(*), 0), 2) AS pct_with_price
FROM card c
LEFT JOIN price p ON p.card_id = c.id
GROUP BY c.set_code
ORDER BY pct_with_price, c.set_code;
 set_code | total_cards | cards_with_price | cards_without_price | pct_with_price 
----------+-------------+------------------+---------------------+----------------
 4bb      |         378 |                0 |                 378 |           0.00 d
 bchr     |         125 |                0 |                 125 |           0.00 d
 fbb      |         307 |                0 |                 307 |           0.00 **
 jp1      |           5 |                0 |                   5 |           0.00 d
 mgb      |          10 |                0 |                  10 |           0.00 d
 o90p     |          10 |                0 |                  10 |           0.00 d
 olep     |          83 |                0 |                  83 |           0.00 d
 olgc     |          27 |                0 |                  27 |           0.00 d
 ovnt     |          35 |                0 |                  35 |           0.00 d
 p30t     |           2 |                0 |                   2 |           0.00 d
 pcel     |           9 |                0 |                   9 |           0.00 d
 ph17     |           3 |                0 |                   3 |           0.00 d
 ph18     |           5 |                0 |                   5 |           0.00 d
 ph19     |           7 |                0 |                   7 |           0.00 d
 ph20     |           3 |                0 |                   3 |           0.00 d
 ph21     |           4 |                0 |                   4 |           0.00 d
 ph22     |           5 |                0 |                   5 |           0.00 d
 ph23     |           1 |                0 |                   1 |           0.00 d
 phtr     |           3 |                0 |                   3 |           0.00 d
 phuk     |          60 |                0 |                  60 |           0.00 d
 pjas     |           6 |                0 |                   6 |           0.00 d
 pjjt     |          12 |                0 |                  12 |           0.00 d
 pjsc     |           2 |                0 |                   2 |           0.00 d
 pmda     |           4 |                0 |                   4 |           0.00 d
 pred     |           1 |                0 |                   1 |           0.00 d
 ps11     |         224 |                0 |                 224 |           0.00 **
 psal     |         720 |                0 |                 720 |           0.00 **
 pssc     |          10 |                0 |                  10 |           0.00 d
 psvc     |           3 |                0 |                   3 |           0.00 d
 punk     |          52 |                0 |                  52 |           0.00 d
 pza      |           1 |                0 |                   1 |           0.00 d
 ren      |         122 |                0 |                 122 |           0.00 d
 rin      |          69 |                0 |                  69 |           0.00 **
 rqs      |          65 |                0 |                  65 |           0.00 d

 unk      |         467 |                3 |                 464 |           0.64 d
 sum      |         306 |                3 |                 303 |           0.98 **
 pwcs     |          42 |                3 |                  39 |           7.14 d
 plg24    |           5 |                1 |                   4 |          20.00 d
 tmt      |          20 |                4 |                  16 |          20.00 d
 ptor     |           3 |                1 |                   2 |          33.33 d
 itp      |          67 |               24 |                  43 |          35.82 **

 pmei     |          80 |               30 |                  50 |          37.50 **
 tmc      |          12 |                5 |                   7 |          41.67 d
 omic     |           2 |                1 |                   1 |          50.00 d
 ovoc     |           2 |                1 |                   1 |          50.00 d
 p9ed     |           2 |                1 |                   1 |          50.00 d
 pewk     |           8 |                4 |                   4 |          50.00 d
 pspl     |           7 |                4 |                   3 |          57.14 d
 pzen     |           5 |                3 |                   2 |          60.00 d
 mul      |         260 |              170 |                  90 |          65.38 **
 pm11     |           6 |                4 |                   2 |          66.67 d
 pwwk     |           6 |                4 |                   2 |          66.67 d
 acr      |         309 |              213 |                  96 |          68.93 **
 p09      |          13 |                9 |                   4 |          69.23 d
 p10      |          13 |                9 |                   4 |          69.23 d
 p11      |           7 |                5 |                   2 |          71.43 d
 2x2      |         579 |              419 |                 160 |          72.37 **
 purl     |          15 |               11 |                   4 |          73.33 d
 oafc     |           4 |                3 |                   1 |          75.00 d
 proe     |           4 |                3 |                   1 |          75.00 d
 ecl      |          33 |               25 |                   8 |          75.76 d
 pw25     |          17 |               13 |                   4 |          76.47 d
 mat      |         230 |              180 |                  50 |          78.26 **
 oc21     |           5 |                4 |                   1 |          80.00 d
 p30m     |           5 |                4 |                   1 |          80.00 d
 phel     |           5 |                4 |                   1 |          80.00 d
 plg21    |          11 |                9 |                   2 |          81.82 d
 pmps08   |           6 |                5 |                   1 |          83.33 d
 cmm      |        1067 |              893 |                 174 |          83.69 **
 cmr      |         718 |              617 |                 101 |          85.93 **
 pjse     |           8 |                7 |                   1 |          87.50 d
 pal99    |          10 |                9 |                   1 |          90.00 d
 pw23     |          11 |               10 |                   1 |          90.91 d
 psus     |          18 |               17 |                   1 |          94.44 d
 wc02     |         143 |              136 |                   7 |          95.10 d
 hho      |          21 |               20 |                   1 |          95.24 d
 pwar     |         176 |              172 |                   4 |          97.73 d
 dci      |          80 |               79 |                   1 |          98.75 d
 wc04     |          93 |               92 |                   1 |          98.92 d
 pfin     |          94 |               93 |                   1 |          98.94 d
 pdom     |         118 |              117 |                   1 |          99.15 d
 cei      |         302 |              301 |                   1 |          99.67 d
 plst     |        4985 |             4978 |                   7 |          99.86 d
 cmb2     |         121 |              121 |                   0 |         100.00 d
 cp1      |           6 |                6 |                   0 |         100.00 d
 cp2      |           6 |                6 |                   0 |         100.00 d
 cp3      |           6 |                6 |                   0 |         100.00 d
 dd1      |          62 |               62 |                   0 |         100.00 d
 ddo      |          65 |               65 |                   0 |         100.00 d
 dvd      |          62 |               62 |                   0 |         100.00 d
 exp      |          45 |               45 |                   0 |         100.00 d
 f01      |           7 |                7 |                   0 |         100.00 d
 f02      |          12 |               12 |                   0 |         100.00 d
 f03      |          13 |               13 |                   0 |         100.00 d
 f04      |          12 |               12 |                   0 |         100.00 d
 f05      |          12 |               12 |                   0 |         100.00 d
 f06      |          12 |               12 |                   0 |         100.00 d
 f07      |          12 |               12 |                   0 |         100.00 d
 f08      |          12 |               12 |                   0 |         100.00 d
 f09      |          12 |               12 |                   0 |         100.00 d
 f10      |          12 |               12 |                   0 |         100.00 d
 f11      |          12 |               12 |                   0 |         100.00 d
 f12      |          12 |               12 |                   0 |         100.00 d
 f13      |          12 |               12 |                   0 |         100.00 d
 f14      |          12 |               12 |                   0 |         100.00 d
 f15      |          12 |               12 |                   0 |         100.00 d
 f16      |          12 |               12 |                   0 |         100.00 d
 f17      |           9 |                9 |                   0 |         100.00 d
 fnm      |          11 |               11 |                   0 |         100.00 d
 g00      |           2 |                2 |                   0 |         100.00 d
 g01      |           2 |                2 |                   0 |         100.00 d
 g02      |           2 |                2 |                   0 |         100.00 d
 g03      |           3 |                3 |                   0 |         100.00 d
 g04      |           6 |                6 |                   0 |         100.00 d
 g05      |           4 |                4 |                   0 |         100.00 d
 g06      |           4 |                4 |                   0 |         100.00 d
 g07      |           5 |                5 |                   0 |         100.00 d
 g08      |           5 |                5 |                   0 |         100.00 d
 g09      |          10 |               10 |                   0 |         100.00 d
 g10      |           8 |                8 |                   0 |         100.00 d
 g11      |           8 |                8 |                   0 |         100.00 d
 g17      |           5 |                5 |                   0 |         100.00 d
 g18      |           5 |                5 |                   0 |         100.00 d
 g99      |           1 |                1 |                   0 |         100.00 d
 gdy      |           9 |                9 |                   0 |         100.00 d
 gvl      |          63 |               63 |                   0 |         100.00 d
 h17      |           3 |                3 |                   0 |         100.00 d
 j12      |           8 |                8 |                   0 |         100.00 d
 j13      |           8 |                8 |                   0 |         100.00 d
 j14      |          14 |               14 |                   0 |         100.00 d
 j15      |           8 |                8 |                   0 |         100.00 d
 j16      |           8 |                8 |                   0 |         100.00 d
 j17      |           9 |                9 |                   0 |         100.00 d
 j18      |           8 |                8 |                   0 |         100.00 d
 j19      |           8 |                8 |                   0 |         100.00 d
 jgp      |           3 |                3 |                   0 |         100.00 d
 jvc      |          62 |               62 |                   0 |         100.00 d
 lmar     |           4 |                4 |                   0 |         100.00 d
 mp2      |          54 |               54 |                   0 |         100.00 d
 mpr      |           1 |                1 |                   0 |         100.00 d
 mps      |          54 |               54 |                   0 |         100.00 d
 nem      |         143 |              143 |                   0 |         100.00 d
 oarc     |          45 |               45 |                   0 |         100.00 d
 oc13     |          15 |               15 |                   0 |         100.00 d
 oc14     |           5 |                5 |                   0 |         100.00 d
 oc15     |           5 |                5 |                   0 |         100.00 d
 oc16     |           5 |                5 |                   0 |         100.00 d
 oc17     |           4 |                4 |                   0 |         100.00 d
 oc18     |           4 |                4 |                   0 |         100.00 d
 oc19     |           4 |                4 |                   0 |         100.00 d
 oc20     |           5 |                5 |                   0 |         100.00 d
 ocm1     |          10 |               10 |                   0 |         100.00 d
 ocmd     |          15 |               15 |                   0 |         100.00 d
 oe01     |          20 |               20 |                   0 |         100.00 d
 ohop     |          40 |               40 |                   0 |         100.00 d
 opc2     |          40 |               40 |                   0 |         100.00 d
 opca     |          86 |               86 |                   0 |         100.00 d
 p03      |           1 |                1 |                   0 |         100.00 d
 p04      |           1 |                1 |                   0 |         100.00 d
 p05      |           6 |                6 |                   0 |         100.00 d
 p06      |           7 |                7 |                   0 |         100.00 d
 p07      |           7 |                7 |                   0 |         100.00 d
 p08      |           7 |                7 |                   0 |         100.00 d
 p10e     |           3 |                3 |                   0 |         100.00 d
 p15a     |           2 |                2 |                   0 |         100.00 d
 p22      |          10 |               10 |                   0 |         100.00 d
 p23      |          10 |               10 |                   0 |         100.00 d
 p2hg     |           1 |                1 |                   0 |         100.00 d
 p30h     |          10 |               10 |                   0 |         100.00 d
 p5dn     |           1 |                1 |                   0 |         100.00 d
 p8ed     |           1 |                1 |                   0 |         100.00 d
 paer     |          65 |               65 |                   0 |         100.00 d
 pakh     |          77 |               77 |                   0 |         100.00 d
 pal00    |          11 |               11 |                   0 |         100.00 d
 pal01    |          12 |               12 |                   0 |         100.00 d
 pal02    |           5 |                5 |                   0 |         100.00 d
 pal03    |           8 |                8 |                   0 |         100.00 d
 pal04    |          14 |               14 |                   0 |         100.00 d
 pal05    |           8 |                8 |                   0 |         100.00 d
 pal06    |           9 |                9 |                   0 |         100.00 d
 pala     |           2 |                2 |                   0 |         100.00 d
 palp     |          15 |               15 |                   0 |         100.00 d
 papc     |           1 |                1 |             
LEFT JOIN price p ON p.card_id = c.id
GROUP BY c.set_code      0 |         100.00 d
 parb     |           3 |                3 |                   0 |         100.00 d
 pavr     |           6 |                6 |                   0 |         100.00 d
 pbbd     |          22 |               22 |                   0 |         100.00 d
 pbfz     |          90 |               90 |                   0 |         100.00 d
 pbig     |           5 |                5 |                   0 |         100.00 d
 pblb     |         160 |              160 |                   0 |         100.00 d
 pbng     |           9 |                9 |                   0 |         100.00 d
 pbok     |           2 |                2 |                   0 |         100.00 d
 pcbb     |           5 |                5 |                   0 |         100.00 d
 pchk     |           1 |                1 |                   0 |         100.00 d
 pclb     |         104 |              104 |                   0 |         100.00 d
 pcmd     |           5 |                5 |                   0 |         100.00 d
 pcmp     |          12 |               12 |                   0 |         100.00 d
 pcmr     |           6 |                6 |                   0 |         100.00 d
 pcns     |           1 |                1 |                   0 |         100.00 d
 pcon     |           2 |                2 |                   0 |         100.00 d
 pcsp     |           1 |                1 |                   0 |         100.00 d
 pdft     |         160 |              160 |                   0 |         100.00 d
 pdgm     |           6 |                6 |                   0 |         100.00 d
 pdis     |           2 |                2 |                   0 |         100.00 d
 pdka     |           5 |                5 |                   0 |         100.00 d
 pdp10    |           2 |                2 |                   0 |         100.00 d
 pdp12    |           3 |                3 |                   0 |         100.00 d
 pdp13    |           3 |                3 |                   0 |         100.00 d
 pdp14    |           3 |                3 |                   0 |         100.00 d
 pdp15    |           2 |                2 |                   0 |         100.00 d
 pdrc     |           1 |                1 |                   0 |         100.00 d 
 pdsk     |         160 |              160 |                   0 |         100.00 d
 pdst     |           1 |                1 |                   0 |         100.00 d
 pdtk     |          51 |               51 |                   0 |         100.00 d
 pdtp     |           1 |                1 |                   0 |         100.00 d
 pelp     |          15 |               15 |                   0 |         100.00 d
 pemn     |          74 |               74 |                   0 |         100.00 d
 peoe     |         160 |              160 |                   0 |         100.00 d
 peve     |           2 |                2 |                   0 |         100.00 d
 pexo     |           1 |                1 |                   0 |         100.00 d
 pf19     |           7 |                7 |                   0 |         100.00 d
 pf20     |           6 |                6 |                   0 |         100.00 d
 pf23     |           4 |                4 |                   0 |         100.00 d
 pf24     |           2 |                2 |                   0 |         100.00 d
 pf25     |          19 |               19 |                   0 |         100.00 d
 pfdn     |          93 |               93 |                   0 |         100.00 d
 pfrf     |          43 |               43 |                   0 |         100.00 d
 pfut     |           2 |                2 |                   0 |         100.00 d
 pgpt     |           2 |                2 |                   0 |         100.00 d
 pgrn     |          84 |               84 |                   0 |         100.00 d
 pgru     |           5 |                5 |                   0 |         100.00 d
 pgtc     |          10 |               10 |                   0 |         100.00 d
 phop     |           1 |                1 |                   0 |         100.00 d
 phou     |          62 |               62 |                   0 |         100.00 d
 pidw     |          17 |               17 |                   0 |         100.00 d
 pinv     |           1 |                1 |                   0 |         100.00 d
 pisd     |           5 |                5 |                   0 |         100.00 d
 pj21     |          10 |               10 |                   0 |         100.00 d
 pjou     |          10 |               10 |                   0 |         100.00 d
 pjud     |           1 |                1 |                   0 |         100.00 d
 pkld     |          83 |               83 |                   0 |         100.00 d
 pktk     |          56 |               56 |                   0 |         100.00 d
 pl21     |           5 |                5 |                   0 |         100.00 d
 pl22     |           5 |                5 |                   0 |         100.00 d
 pl23     |           5 |                5 |                   0 |         100.00 d
 pl24     |           6 |                6 |                   0 |         100.00 d
 pl25     |           5 |                5 |                   0 |         100.00 d
 plg20    |           2 |                2 |                   0 |         100.00 d
 plg22    |           2 |                2 |                   0 |         100.00 d
 plg25    |           2 |                2 |                   0 |         100.00 d
 plgm     |           2 |                2 |                   0 |         100.00 d
 plgn     |           1 |                1 |                   0 |         100.00 d
 plrw     |           3 |                3 |                   0 |         100.00 d
 pltc     |           4 |                4 |                   0 |         100.00 d
 pltr     |          86 |               86 |                   0 |         100.00 d
 pm10     |           3 |                3 |                   0 |         100.00 d
 pm12     |           3 |                3 |                   0 |         100.00 d
 pm13     |           6 |                6 |                   0 |         100.00 d
 pm14     |           6 |                6 |                   0 |         100.00 d
 pm15     |          14 |               14 |                   0 |         100.00 d
 pm19     |          95 |               95 |                   0 |         100.00 d
 pm20     |         144 |              144 |                   0 |         100.00 d
 pmat     |           8 |                8 |                   0 |         100.00 d
 pmbs     |           4 |                4 |                   0 |         100.00 d
 pmh1     |           2 |                2 |                   0 |         100.00 d
 pmh2     |          86 |               86 |                   0 |         100.00 d
 pmh3     |          85 |               85 |                   0 |         100.00 d
 pmic     |           1 |                1 |                   0 |         100.00 d
 pmmq     |           1 |                1 |                   0 |         100.00 d
 pmor     |           2 |                2 |                   0 |         100.00 d
 pmps06   |           5 |                5 |                   0 |         100.00 d
 pmps07   |           5 |                5 |                   0 |         100.00 d
 pmps09   |           5 |                5 |                   0 |         100.00 d
 pmps10   |           5 |                5 |                   0 |         100.00 d
 pmps11   |           5 |                5 |                   0 |         100.00 d
 pmrd     |           1 |                1 |                   0 |         100.00 d
 pnat     |           1 |                1 |                   0 |         100.00 d
 pncc     |          75 |               75 |                   0 |         100.00 d
 pnem     |           1 |                1 |                   0 |         100.00 d
 pnph     |           4 |                4 |                   0 |         100.00 d
 pody     |           1 |                1 |                   0 |         100.00 d
 pogw     |          65 |               65 |                   0 |         100.00 d
 pons     |           1 |                1 |                   0 |         100.00 d
 pori     |          54 |               54 |                   0 |         100.00 d
 ppc1     |           1 |                1 |                   0 |         100.00 d
 ppcy     |           1 |                1 |                   0 |         100.00 d
 pplc     |           2 |                2 |                   0 |         100.00 d
 ppls     |           1 |                1 |                   0 |         100.00 d
 ppp1     |           5 |                5 |                   0 |         100.00 d
 pptk     |           2 |                2 |                   0 |         100.00 d
 pr23     |           3 |                3 |                   0 |         100.00 d
 prav     |           2 |                2 |                   0 |         100.00 d
 prcq     |           3 |                3 |                   0 |         100.00 d
 prix     |          98 |               98 |                   0 |         100.00 d
 prna     |          81 |               81 |                   0 |         100.00 d
 prtr     |          10 |               10 |                   0 |         100.00 d
 prw2     |          10 |               10 |                   0 |         100.00 d
 prwk     |          10 |               10 |                   0 |         100.00 d
 ps14     |           6 |                6 |                   0 |         100.00 d
 ps15     |           5 |                5 |                   0 |         100.00 d
 ps16     |           5 |                5 |                   0 |         100.00 d
 ps17     |           6 |                6 |                   0 |         100.00 d
 ps18     |           5 |                5 |                   0 |         100.00 d
 ps19     |           5 |                5 |                   0 |         100.00 d
 pscg     |           1 |                1 |                   0 |         100.00 d
 psdc     |           5 |                5 |                   0 |         100.00 d
 pshm     |           2 |                2 |                   0 |         100.00 d
 psoi     |          90 |               90 |                   0 |         100.00 d
 psok     |           2 |                2 |                   0 |         100.00 d
 psom     |           4 |                4 |                   0 |         100.00 d
 pspm     |          68 |               68 |                   0 |         100.00 d
 pss1     |           5 |                5 |                   0 |         100.00 d
 pss2     |           5 |                5 |                   0 |         100.00 d
 pss3     |           5 |                5 |                   0 |         100.00 d
 pss4     |           5 |                5 |                   0 |         100.00 d
 pss5     |           2 |                2 |                   0 |         100.00 d
 psth     |           1 |                1 |                   0 |         100.00 d
 ptc      |         307 |              307 |                   0 |         100.00 d
 ptdm     |         160 |              160 |                   0 |         100.00 d
 pthb     |         137 |              137 |                   0 |         100.00 d
 pths     |          10 |               10 |                   0 |         100.00 d
 ptkdf    |           4 |                4 |                   0 |         100.00 d
 ptmp     |           1 |                1 |                   0 |         100.00 d
 ptsp     |           3 |                3 |                   0 |         100.00 d
 ptsr     |           3 |                3 |                   0 |         100.00 d
 puds     |           1 |                1 |                   0 |         100.00 d
 pulg     |           2 |                2 |                   0 |         100.00 d
 punh     |           1 |                1 |                   0 |         100.00 d
 pusg     |           1 |                1 |                   0 |         100.00 d
 pust     |           1 |                1 |                   0 |         100.00 d
 pvow     |         121 |              121 |                   0 |         100.00 d
 pw11     |           3 |                3 |                   0 |         100.00 d
 pw12     |           3 |                3 |                   0 |         100.00 d
 pw21     |           6 |                6 |                   0 |         100.00 d
 pw22     |           6 |                6 |                   0 |         100.00 d
 pw24     |          18 |               18 |                   0 |         100.00 d
 pwor     |           2 |                2 |                   0 |         100.00 d
 pwos     |           1 |                1 |                   0 |         100.00 d
 pxln     |         120 |              120 |                   0 |         100.00 d
 pxtc     |          10 |               10 |                   0 |         100.00 d
 q06      |          10 |               10 |                   0 |         100.00 d
 rfin     |           2 |                2 |                   0 |         100.00 d
 sch      |          44 |               44 |                   0 |         100.00 d
 sunf     |          48 |               48 |                   0 |         100.00 d
 tbth     |          10 |               10 |                   0 |         100.00 d
 tdag     |           8 |                8 |                   0 |         100.00 d
 tfth     |          10 |               10 |                   0 |         100.00 d
 thp2     |           7 |                7 |                   0 |         100.00 d
 thp3     |           7 |                7 |                   0 |         100.00 d
 ulst     |          62 |               62 |                   0 |         100.00 d
 ust      |         268 |              268 |                   0 |         100.00 d
 wc00     |         107 |              107 |                   0 |         100.00 d
 wc01     |         128 |              128 |                   0 |         100.00 d
 wc03     |         132 |              132 |                   0 |         100.00 d
 wc97     |         121 |              121 |                   0 |         100.00 d
 wc98     |         107 |              107 |                   0 |         100.00 d
 wc99     |         100 |              100 |                   0 |         100.00 d
 wmc      |           5 |                5 |                   0 |         100.00 d
(678 rows)

THIS QUERY SHOWS THAT EVERY EXPANSION CARD STARTS WITH AN INTEGER
select distinct number from card where is_alternative=false and id in (select card_id from price) and set_code in (select code from set where type='expansion') order by number;



-- Count of cards grouped by set.type (includes set types with zero cards)
SELECT
  s.type,
  COUNT(c.id) AS card_count
FROM "set" s
LEFT JOIN card c ON c.set_code = s.code
GROUP BY s.type
ORDER BY card_count DESC;

       type       | card_count 
------------------+------------
 expansion        |      29523
 commander        |      14104
 masters          |      11489
 core             |       9626
 promo            |       8024
 draft_innovation |       7761
 box              |       4590
 memorabilia      |       2756
 funny            |       2187
 duel_deck        |       1838
 masterpiece      |       1424
 starter          |        926
 planechase       |        647
 eternal          |        430
 archenemy        |        321
 from_the_vault   |        155
 premium_deck     |        105
 arsenal          |         34
 vanguard         |         32
 spellbook        |         2
LEFT JOIN price p ON p.card_id = c.id
GROUP BY c.set_code;

-- Get all sets base_size and number of cards in set 
SELECT
s.code,
s.name,
s.base_size,
COUNT(c.id) AS card_count,
s.release_date,
s.type
FROM "set" s
LEFT JOIN card c ON c.set_code = s.code
GROUP BY s.code, s.name, s.base_size, s.release_date, s.type
ORDER BY s.code;


-- SETS WITH 0 CARDS in ENGLISH:
select distinct set_code from card where set_code in (
'4bb',
'aacr',
'aafr',
'ablb',
'abro',
'aclb',
'acmm',
'adft',
'admu',
'adsk',
'aeoe',
'afdn',
'afic',
'afin',
'ainr',
'akhm',
'alci',
'altc',
'altr',
'amh1',
'amh2',
'amh3',
'amid',
'amkm',
'amom',
'aneo',
'aone',
'aotj',
'asnc',
'astx',
'atdm',
'avow',
'awoe',
'aznr',
'bchr',
'dd3',
'f18',
'fbb',
'fbro',
'fclu',
'fdmu',
'ffdn',
'fj22',
'fj25',
'fjmp',
'fltr',
'fmom',
'fone',
'ftla',
'fwb',
'jp1',
'l12',
'l13',
'l14',
'l15',
'l16',
'l17',
'macr',
'mafr',
'mb1',
'mbro',
'mclb',
'mdmu',
'mkhm',
'mltr',
'mmh2',
'mmid',
'mneo',
'mone',
'msnc',
'mstx',
'mvow',
'mznr',
'oafr',
'oclb',
'p30t',
'papc',
'pinv',
'pjjt',
'pjsc',
'pjud',
'plny',
'pmda',
'pmps',
'pmps06',
'pmps07',
'pmps08',
'pmps09',
'pmps10',
'pmps11',
'pody',
'ppls',
'pr2',
'pred',
'ps11',
'psal',
'psdg',
'psvc',
'ptbro',
'ptdmu',
'ptor',
'ptsnc',
'pwcs',
'q01',
'q02',
'q03',
'q04',
'q05',
'q07',
'q08',
'ren',
'rfin',
'rin',
'sbro',
'skhm',
'slci',
'smh3',
'smid',
'smom',
'sneo',
'sstx',
'svow',
'sznr',
'wdmu',
'wfin',
'wmkm',
'wmom',
'wone',
'wwoe'
) ORDER BY set_code;

Sets/Cards not getting filtered that are non-english only: 
 set_code 
----------
 bchr
 jp1
 p30t
 papc
 pinv
 pjsc
 pjud
 pmda
 pody
 ppls
 psvc
 ptor
 pwcs
 rfin
(14 rows)

i_want_my_mtg=# SELECT DISTINCT
    regexp_replace(number, '[\x00-\x7F]', '', 'g') AS non_ascii_chars
FROM card
WHERE number ~ '[^\x00-\x7F]'
  AND regexp_replace(number, '[\x00-\x7F]', '', 'g') <> '';
 non_ascii_chars 
-----------------
 Φ
 †
 ★

WITH non_ascii_chars AS (
    SELECT
        c.id,
        c.set_code,
        unnest(string_to_array(regexp_replace(c.number, '[\x00-\x7F]', '', 'g'), '')) AS ch
    FROM card c
    WHERE c.number ~ '[^\x00-\x7F]'
),
filtered AS (
    SELECT DISTINCT id, set_code, ch
    FROM non_ascii_chars
)
SELECT
    ch AS non_ascii_character,
    COUNT(DISTINCT id) AS card_count,
    COUNT(DISTINCT set_code) AS set_count
FROM filtered
GROUP BY ch
ORDER BY ch;
 non_ascii_character | card_count | set_count 
---------------------+------------+-----------
 Φ                   |          4 |         1
 †                   |         72 |        20
 ★                   |       1878 |        90
(3 rows)


QUERY TO SORT NUMERICALLY THEN LEXICALLY:
SELECT DISTINCT
  number,
  COALESCE((regexp_match(number, '^[0-9]+'))[1]::int, 2147483647) AS numkey
FROM card
ORDER BY
  numkey,
  number;



------
-- ****************************************
-- * SETS with CARDS with NON-ASCII Chars *
-- ****************************************
SELECT
  s.code,
  s.name, s.base_size,
  COUNT(c.id) AS non_ascii_count
FROM "set" s
JOIN card c ON c.set_code = s.code
WHERE c.number ~ '[^\x00-\x7F]'
GROUP BY s.code, s.name
HAVING COUNT(c.id) > 0
ORDER BY non_ascii_count DESC, s.code;
 code  |               name               | base_size | non_ascii_count 
-------+----------------------------------+-----------+---------------- 
 7ed   | Seventh Edition                  |       350 |             350 
 8ed   | Eighth Edition                   |       350 |             350 
 9ed   | Ninth Edition                    |       350 |             350 
 40k   | Warhammer 40,000 Commander       |       617 |             296 
 10e   | Tenth Edition                    |       383 |             125 
 sld   | Secret Lair Drop                 |         1 |             123 
 war   | War of the Spark                 |       264 |              36 
 pwar  | War of the Spark Promos          |       176 |              33 
 unh   | Unhinged                         |       140 |              27 
 arn   | Arabian Nights                   |        78 |              14 
 mkm   | Murders at Karlov Manor          |       286 |              11 
 pbng  | Born of the Gods Promos          |         9 |               7 
 pgtc  | Gatecrash Promos                 |        10 |               7 
 pjou  | Journey into Nyx Promos          |        10 |               7 
 por   | Portal                           |       243 |               7 
 prtr  | Return to Ravnica Promos         |        10 |               7 
 pths  | Theros Promos                    |        10 |               7 
 frf   | Fate Reforged                    |       185 |               6 
 5ed   | Fifth Edition                    |       455 |               5 
 j14   | Judge Gift Cards 2014            |         9 |               5 
 p30h  | 30th Anniversary History Promos  |        10 |               5 
 pkhm  | Kaldheim Promos                  |         1 |               5 
 pm13  | Magic 2013 Promos                |         6 |               5 
 pm14  | Magic 2014 Promos                |         6 |               5 
 psdc  | San Diego Comic-Con 2013         |         5 |               5 
 soi   | Shadows over Innistrad           |       297 |               5 
 fin   | Final Fantasy                    |       309 |               4 
 kld   | Kaladesh                         |       264 |               4 
 pdgm  | Dragon's Maze Promos             |         6 |               4 
 pmbs  | Mirrodin Besieged Promos         |         4 |               4 
 aer   | Aether Revolt                    |       184 |               3 
 drk   | The Dark                         |       119 |               3 
 pavr  | Avacyn Restored Promos           |         6 |               3 
 pdka  | Dark Ascension Promos            |         5 |               3 
 pls   | Planeshift                       |       143 |               3 
 plst  | The List                         |      5075 |               3 
 pm10  | Magic 2010 Promos                |         3 |               3 
 pm11  | Magic 2011 Promos                |         6 |               3 
 pm12  | Magic 2012 Promos                |         3 |               3 
 pmid  | Innistrad: Midnight Hunt Promos  |       171 |               3 
 pnph  | New Phyrexia Promos              |         4 |               3 
 proe  | Rise of the Eldrazi Promos       |         4 |               3 
 psom  | Scars of Mirrodin Promos         |         4 |               3 
 pzen  | Zendikar Promos                  |         5 |               3 
 atq   | Antiquities                      |       100 |               2 
 dd2   | Duel Decks: Jace vs. Chandra     |        62 |               2 
 dkm   | Deckmasters                      |        50 |               2 
 gpt   | Guildpact                        |       165 |               2 
 hho   | Happy Holidays                   |        21 |               2 
 inv   | Invasion                         |       350 |               2 
 ody   | Odyssey                          |       350 |               2 
 p30m  | 30th Anniversary Misc Promos     |         5 |               2 
 parb  | Alara Reborn Promos              |         3 |               2 
 pbok  | Betrayers of Kamigawa Promos     |         2 |               2 
 pcon  | Conflux Promos                   |         2 |               2 
 pdis  | Dissension Promos                |         2 |               2 
 peld  | Throne of Eldraine Promos        |       152 |               2 
 peve  | Eventide Promos                  |         2 |               2 
 pfut  | Future Sight Promos              |         2 |               2 
 pgpt  | Guildpact Promos                 |         2 |               2 
 pisd  | Innistrad Promos                 |         5 |               2 
 plrw  | Lorwyn Promos                    |         3 |               2 
 pmor  | Morningtide Promos               |         2 |               2 
 pneo  | Kamigawa: Neon Dynasty Promos    |       157 |               2 
 pplc  | Planar Chaos Promos              |         2 |               2 
 prav  | Ravnica: City of Guilds Promos   |         2 |               2 
 pshm  | Shadowmoor Promos                |         2 |               2 
 psok  | Saviors of Kamigawa Promos       |         2 |               2 
 ptsp  | Time Spiral Promos               |         3 |               2 
 pvow  | Innistrad: Crimson Vow Promos    |       137 |               2 
 pwwk  | Worldwake Promos                 |         6 |               2 
 4ed   | Fourth Edition                   |       378 |               1 
 fca   | Final Fantasy: Through the Ages  |         0 |               1 
 m20   | Core Set 2020                    |       280 |               1 
 mir   | Mirage                           |       350 |               1 
 ogw   | Oath of the Gatewatch            |       184 |               1 
 ons   | Onslaught                        |       350 |               1 
 p5dn  | Fifth Dawn Promos                |         1 |               1 
 p8ed  | Eighth Edition Promos            |         1 |               1 
 p9ed  | Ninth Edition Promos             |         2 |               1 
 pakh  | Amonkhet Promos                  |        77 |               1 
 pal99 | Arena League 1999                |       350 |               1 
 pala  | Shards of Alara Promos           |         2 |               1 
 pbfz  | Battle for Zendikar Promos       |        90 |               1 
 pchk  | Champions of Kamigawa Promos     |         1 |               1 
 pcns  | Conspiracy Promos                |         1 |               1 
 pcsp  | Coldsnap Promos                  |         1 |               1 
 pdmu  | Dominaria United Promos          |       161 |               1 
 pdst  | Darksteel Promos                 |         1 |               1 
 pemn  | Eldritch Moon Promos             |        77 |               1 
 pfrf  | Fate Reforged Promos             |        43 |               1 
 pgrn  | Guilds of Ravnica Promos         |        84 |               1 
 piko  | Ikoria: Lair of Behemoths Promos |       137 |               1 
 pkld  | Kaladesh Promos                  |        83 |               1 
 pl21  | Year of the Ox 2021              |         4 |               1 
 pm15  | Magic 2015 Promos                |        14 |               1 
 pm19  | Core Set 2019 Promos             |        95 |               1 
 pm21  | Core Set 2021 Promos             |       137 |               1 
 pmrd  | Mirrodin Promos                  |         1 |               1 
 pori  | Magic Origins Promos             |        54 |               1 
 prix  | Rivals of Ixalan Promos          |        98 |               1 
 prna  | Ravnica Allegiance Promos        |        81 |               1 
 psnc  | Streets of New Capenna Promos    |       161 |               1 
 psoi  | Shadows over Innistrad Promos    |        89 |               1 
 pthb  | Theros Beyond Death Promos       |       137 |               1 
 pulg  | Urza's Legacy Promos             |         1 |               1 
 punh  | Unhinged Promos                  |         1 |               1 
 pznr  | Zendikar Rising Promos           |       169 |               1 
 shm   | Shadowmoor                       |       301 |               1 
 stx   | Strixhaven: School of Mages      |       275 |               1 
 thb   | Theros Beyond Death              |       254 |               1 
(111 rows)


 code  |               name               | base_size | non_ascii_count |    type       | dupes action  
-------+----------------------------------+-----------+-----------------+-------------  +------------
 sld   | Secret Lair Drop                 |         1 |             123 | box           | * * * TODO * * *
 plst  | The List                         |      5075 |               3 | masters       | * * * TODO * * *
 4ed   | Fourth Edition                   |       378 |               1 | core          | (check with JQ - reorder if legit [misprint])
 fin   | Final Fantasy                    |       309 |               4 | expansion     | delete or reorder cross 
 40k   | Warhammer 40,000 Commander       |       617 |             296 | commander     | delete
 7ed   | Seventh Edition                  |       350 |             350 | core          | delete
 8ed   | Eighth Edition                   |       350 |             350 | core          | delete
 9ed   | Ninth Edition                    |       350 |             350 | core          | delete
 10e   | Tenth Edition                    |       383 |             125 | core          | delete
 dkm   | Deckmasters                      |        50 |               2 | box           | merge delete (star)
 unh   | Unhinged                         |       140 |              27 | funny         | merge delete
 frf   | Fate Reforged                    |       185 |               6 | expansion     | merge delete
 ons   | Onslaught                        |       350 |               1 | expansion     | merge delete (star)
 shm   | Shadowmoor                       |       301 |               1 | expansion     | merge delete (star)
 stx   | Strixhaven: School of Mages      |       275 |               1 | expansion     | merge delete (star)
 thb   | Theros Beyond Death              |       254 |               1 | expansion     | merge delete (star)
 war   | War of the Spark                 |       264 |              36 | expansion     | reorder
 arn   | Arabian Nights                   |        78 |              14 | expansion     | reorder (cross)
 mkm   | Murders at Karlov Manor          |       286 |              11 | expansion     | reorder (cross)
 soi   | Shadows over Innistrad           |       297 |               5 | expansion     | reorder (cross with [a|b|c|d|e])
 kld   | Kaladesh                         |       264 |               4 | expansion     | reorder
 aer   | Aether Revolt                    |       184 |               3 | expansion     | reorder (cross)
 drk   | The Dark                         |       119 |               3 | expansion     | reorder (cross)
 pls   | Planeshift                       |       143 |               3 | expansion     | reorder (star)
 atq   | Antiquities                      |       100 |               2 | expansion     | reorder (cross)
 mir   | Mirage                           |       350 |               1 | expansion     | reorder (cross - misprint)
 ogw   | Oath of the Gatewatch            |       184 |               1 | expansion     | reorder (cross) (keep a)
 gpt   | Guildpact                        |       165 |               2 | expansion     | reorder (star)
 inv   | Invasion                         |       350 |               2 | expansion     | reorder (star)
 ody   | Odyssey                          |       350 |               2 | expansion     | reorder (cross - misprints)
 dd2   | Duel Decks: Jace vs. Chandra     |        62 |               2 | duel_deck     | reorder (star)
 hho   | Happy Holidays                   |        21 |               2 | funny         | reorder (cross)
 fca   | Final Fantasy: Through the Ages  |         0 |               1 | masterpiece   | reorder (cross - misprint)
 por   | Portal                           |       243 |               7 | starter       | reorder (d|s|cross)
 5ed   | Fifth Edition                    |       455 |               5 | core          | reorder 
 m20   | Core Set 2020                    |       280 |               1 | core          | reorder (cross - misprint)
 j14   | Judge Gift Cards 2014            |         9 |               5 | promo         | reorder (looks like 2 different sets in one)
 p30h  | 30th Anniversary History Promos  |        10 |               5 | promo         | reorder
 pwar  | War of the Spark Promos          |       176 |              33 | promo         | keep | reorder
 pwwk  | Worldwake Promos                 |         6 |               2 | promo         | keep | reorder
 pbng  | Born of the Gods Promos          |         9 |               7 | promo         | keep 
 pgtc  | Gatecrash Promos                 |        10 |               7 | promo         | keep
 pjou  | Journey into Nyx Promos          |        10 |               7 | promo         | keep
 prtr  | Return to Ravnica Promos         |        10 |               7 | promo         | keep
 pths  | Theros Promos                    |        10 |               7 | promo         | keep
 pkhm  | Kaldheim Promos                  |         1 |               5 | promo         | keep
 pm13  | Magic 2013 Promos                |         6 |               5 | promo         | keep
 pm14  | Magic 2014 Promos                |         6 |               5 | promo         | keep
 psdc  | San Diego Comic-Con 2013         |         5 |               5 | promo         | keep
 pdgm  | Dragon's Maze Promos             |         6 |               4 | promo         | keep
 pmbs  | Mirrodin Besieged Promos         |         4 |               4 | promo         | keep
 pavr  | Avacyn Restored Promos           |         6 |               3 | promo         | keep
 pdka  | Dark Ascension Promos            |         5 |               3 | promo         | keep
 pm10  | Magic 2010 Promos                |         3 |               3 | promo         | keep
 pm11  | Magic 2011 Promos                |         6 |               3 | promo         | keep
 pm12  | Magic 2012 Promos                |         3 |               3 | promo         | keep
 pmid  | Innistrad: Midnight Hunt Promos  |       171 |               3 | promo         | keep
 pnph  | New Phyrexia Promos              |         4 |               3 | promo         | keep
 proe  | Rise of the Eldrazi Promos       |         4 |               3 | promo         | keep
 psom  | Scars of Mirrodin Promos         |         4 |               3 | promo         | keep
 pzen  | Zendikar Promos                  |         5 |               3 | promo         | keep
 p30m  | 30th Anniversary Misc Promos     |         5 |               2 | promo         | keep
 parb  | Alara Reborn Promos              |         3 |               2 | promo         | keep
 pbok  | Betrayers of Kamigawa Promos     |         2 |               2 | promo         | keep
 pcon  | Conflux Promos                   |         2 |               2 | promo         | keep
 pdis  | Dissension Promos                |         2 |               2 | promo         | keep
 peld  | Throne of Eldraine Promos        |       152 |               2 | promo         | keep
 peve  | Eventide Promos                  |         2 |               2 | promo         | keep
 pfut  | Future Sight Promos              |         2 |               2 | promo         | keep
 pgpt  | Guildpact Promos                 |         2 |               2 | promo         | keep
 pisd  | Innistrad Promos                 |         5 |               2 | promo         | keep
 plrw  | Lorwyn Promos                    |         3 |               2 | promo         | keep
 pmor  | Morningtide Promos               |         2 |               2 | promo         | keep
 pneo  | Kamigawa: Neon Dynasty Promos    |       157 |               2 | promo         | keep
 pplc  | Planar Chaos Promos              |         2 |               2 | promo         | keep
 prav  | Ravnica: City of Guilds Promos   |         2 |               2 | promo         | keep
 pshm  | Shadowmoor Promos                |         2 |               2 | promo         | keep
 psok  | Saviors of Kamigawa Promos       |         2 |               2 | promo         | keep
 ptsp  | Time Spiral Promos               |         3 |               2 | promo         | keep
 pvow  | Innistrad: Crimson Vow Promos    |       137 |               2 | promo         | keep
 p5dn  | Fifth Dawn Promos                |         1 |               1 | promo         | keep
 p8ed  | Eighth Edition Promos            |         1 |               1 | promo         | keep
 p9ed  | Ninth Edition Promos             |         2 |               1 | promo         | keep
 pakh  | Amonkhet Promos                  |        77 |               1 | promo         | keep
 pal99 | Arena League 1999                |       350 |               1 | promo         | keep
 pala  | Shards of Alara Promos           |         2 |               1 | promo         | keep
 pbfz  | Battle for Zendikar Promos       |        90 |               1 | promo         | keep
 pchk  | Champions of Kamigawa Promos     |         1 |               1 | promo         | keep
 pcns  | Conspiracy Promos                |         1 |               1 | promo         | keep
 pcsp  | Coldsnap Promos                  |         1 |               1 | promo         | keep
 pdmu  | Dominaria United Promos          |       161 |               1 | promo         | keep
 pdst  | Darksteel Promos                 |         1 |               1 | promo         | keep
 pemn  | Eldritch Moon Promos             |        77 |               1 | promo         | keep
 pfrf  | Fate Reforged Promos             |        43 |               1 | promo         | keep
 pgrn  | Guilds of Ravnica Promos         |        84 |               1 | promo         | keep
 piko  | Ikoria: Lair of Behemoths Promos |       137 |               1 | promo         | keep
 pkld  | Kaladesh Promos                  |        83 |               1 | promo         | keep
 pl21  | Year of the Ox 2021              |         4 |               1 | promo         | keep
 pm15  | Magic 2015 Promos                |        14 |               1 | promo         | keep
 pm19  | Core Set 2019 Promos             |        95 |               1 | promo         | keep
 pm21  | Core Set 2021 Promos             |       137 |               1 | promo         | keep
 pmrd  | Mirrodin Promos                  |         1 |               1 | promo         | keep
 pori  | Magic Origins Promos             |        54 |               1 | promo         | keep
 prix  | Rivals of Ixalan Promos          |        98 |               1 | promo         | keep
 prna  | Ravnica Allegiance Promos        |        81 |               1 | promo         | keep
 psnc  | Streets of New Capenna Promos    |       161 |               1 | promo         | keep
 psoi  | Shadows over Innistrad Promos    |        89 |               1 | promo         | keep
 pthb  | Theros Beyond Death Promos       |       137 |               1 | promo         | keep
 pulg  | Urza's Legacy Promos             |         1 |               1 | promo         | keep
 punh  | Unhinged Promos                  |         1 |               1 | promo         | keep
 pznr  | Zendikar Rising Promos           |       169 |               1 | promo         | keep
 